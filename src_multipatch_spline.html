<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Gyselalib++: Spline on multipatch geometry</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Gyselalib++
   </div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.svg"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('src_multipatch_spline.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Spline on multipatch geometry </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>This directory defines structures and methods to deal with different splines on every patches. The multipatch patch operators implemented are</p>
<ul>
<li><a href="#src_multipatch_spline__Multipatch_spline_builder">Multipatch spline builder</a> - Definition of <code><a class="el" href="classMultipatchSplineBuilder.html" title="A class to call all the builders of all the patches once.">MultipatchSplineBuilder</a></code> and <code><a class="el" href="classMultipatchSplineBuilder2D.html" title="A class to call all the builders of all the patches once.">MultipatchSplineBuilder2D</a></code>.</li>
<li><a href="#src_multipatch_spline__Multipatch_spline_evaluator">Multipatch spline evaluator</a> - Definition of <code><a class="el" href="classMultipatchSplineEvaluator2D.html" title="A class to evaluate all the splines of all the patches at once.">MultipatchSplineEvaluator2D</a></code>.</li>
<li><a href="#src_multipatch_spline__Multipatch_extrapolation_rules">Multipatch extrapolation rules</a> - Definition of extrapolation rules depending on the geometries for <code><a class="el" href="classMultipatchSplineEvaluator2D.html" title="A class to evaluate all the splines of all the patches at once.">MultipatchSplineEvaluator2D</a></code>.</li>
</ul>
<h1><a class="anchor" id="src_multipatch_spline__Multipatch_spline_builder"></a>
Multipatch spline builder</h1>
<p>The <code><a class="el" href="classMultipatchSplineBuilder.html" title="A class to call all the builders of all the patches once.">MultipatchSplineBuilder</a></code> and <code><a class="el" href="classMultipatchSplineBuilder2D.html" title="A class to call all the builders of all the patches once.">MultipatchSplineBuilder2D</a></code> allow all the given spline builders to be called in one single line.</p>
<p>The template parameters of this class reproduce the <code>SplineBuilder</code> and <code>SplineBuilder2D</code> classes from DDC. The spline coefficients and values of the functions are stored in <code><a class="el" href="classMultipatchType.html" title="A class to store several objects that are of a type which is templated by the patch.">MultipatchType</a></code> objects. The spline builders are stored inside the class in a <code>std::tuple</code>.</p>
<p>For Hermite boundary conditions, derivatives have to be provided. They are also stored in <code><a class="el" href="classMultipatchType.html" title="A class to store several objects that are of a type which is templated by the patch.">MultipatchType</a></code> objects.</p>
<h3><a class="anchor" id="autotoc_md74"></a>
Example of use of MultipatchSplineBuilder</h3>
<p>We define all the builders for each patch, </p><div class="fragment"><div class="line">SplineBuilderType1 builder_1(idx_range_1); </div>
<div class="line">SplineBuilderType2 builder_2(idx_range_2); </div>
<div class="line">SplineBuilderType3 builder_3(idx_range_3); </div>
<div class="line">...</div>
</div><!-- fragment --><p>We can instantiate a <a class="el" href="classMultipatchSplineBuilder.html" title="A class to call all the builders of all the patches once.">MultipatchSplineBuilder</a> from these builders, </p><div class="fragment"><div class="line"><a class="code" href="classMultipatchSplineBuilder.html">MultipatchSplineBuilder</a> builder (builder_1, builder_2, builder_3); </div>
<div class="ttc" id="aclassMultipatchSplineBuilder_html"><div class="ttname"><a href="classMultipatchSplineBuilder.html">MultipatchSplineBuilder</a></div><div class="ttdoc">A class to call all the builders of all the patches once.</div><div class="ttdef"><b>Definition:</b> multipatch_spline_builder.hpp:56</div></div>
</div><!-- fragment --><p>We allocate memory for the spline representations on each patch, </p><div class="fragment"><div class="line">SplineType1 spline_1(spline_idx_range_1); </div>
<div class="line">SplineType2 spline_2(spline_idx_range_2); </div>
<div class="line">SplineType3 spline_3(spline_idx_range_3); </div>
<div class="line">...</div>
<div class="line">MultipatchType&lt;SplineTypeOnPatch, Patch1, Patch2, Patch3&gt; patches_splines (spline_1, spline_2, spline_3); </div>
</div><!-- fragment --><p>We do the same with the values of the function, </p><div class="fragment"><div class="line">ValuesType1 values_1(idx_range_1); </div>
<div class="line">ValuesType2 values_2(idx_range_2); </div>
<div class="line">ValuesType3 values_3(idx_range_3); </div>
<div class="line">...</div>
<div class="line"><span class="comment">// initialisation </span></div>
<div class="line">...</div>
<div class="line"><a class="code" href="classMultipatchType.html">MultipatchType&lt;ValuesTypeOnPatch, Patch1, Patch2, Patch3&gt;</a>  patches_values (values_1, values_2, values_3); </div>
<div class="ttc" id="aclassMultipatchType_html"><div class="ttname"><a href="classMultipatchType.html">MultipatchType</a></div><div class="ttdoc">A class to store several objects that are of a type which is templated by the patch.</div><div class="ttdef"><b>Definition:</b> multipatch_type.hpp:32</div></div>
</div><!-- fragment --><p>And we build the spline representation on every patch using, </p><div class="fragment"><div class="line">builder(patches_splines, patches_values); </div>
</div><!-- fragment --><h1><a class="anchor" id="src_multipatch_spline__Multipatch_spline_evaluator"></a>
Multipatch spline evaluator</h1>
<p>The <code><a class="el" href="classMultipatchSplineEvaluator2D.html" title="A class to evaluate all the splines of all the patches at once.">MultipatchSplineEvaluator2D</a></code> allows all the spline evaluators to be called in one single line.</p>
<p>Contrary to the <code><a class="el" href="classMultipatchSplineBuilder.html" title="A class to call all the builders of all the patches once.">MultipatchSplineBuilder</a></code> class, the spline evaluators are not given as input but we directly compute the evaluation inside the class. The template parameters and aliases are similar to the ones in the <code>SplineEvaluator2D</code> class in DDC.</p>
<p>To instantiate a <code><a class="el" href="classMultipatchSplineEvaluator2D.html" title="A class to evaluate all the splines of all the patches at once.">MultipatchSplineEvaluator2D</a></code>, we need a patch locator operator to be able to determine on which patch the given (see <a class="el" href="src_multipatch_connectivity.html">Multipatch connectivity</a>) coordinates will be physically located. We also need extrapolation rules to know what type of value returning if case of the coordinates are outside of the domain. Multipatch extrapolation rules are implemented and defined below <a href="#src_multipatch_spline__Multipatch_extrapolation_rules">Multipatch extrapolation rules</a>.</p>
<p>The coordinates are stored in fields stored in <code><a class="el" href="classMultipatchType.html" title="A class to store several objects that are of a type which is templated by the patch.">MultipatchType</a></code> objects. They are stored on patches. Each field corresponds to the coordinates stored on a given patch. The coordinates are not enforced to be physically located on the storing patch.</p>
<blockquote class="doxtable">
<p>For example, these coordinates can be characteristic feet stored on the patch where the initial coordinates were. Here the coordinates are in the same field if their initial coordinates were on the same patch. They are on the same storing patch, but some of them can be physically located outside of the storing patch if the feet have crossed the edges. </p>
</blockquote>
<p>Similarly to <code>SplineEvaluator2D</code>, methods to get the derivatives are implemented. No extrapolation rules are given, so <code><a class="el" href="classMultipatchSplineEvaluator2D.html" title="A class to evaluate all the splines of all the patches at once.">MultipatchSplineEvaluator2D</a></code> will throw an exception error if we give a coordinate outside of the domain. The methods implemented are</p><ul>
<li><code>operator()</code> to compute a single value or fields of values.</li>
<li><code>deriv_dim_1()</code>, <code>deriv_dim_2()</code> to compute derivatives on the first or second dimension on a single coordinates or fields of coordinates.</li>
<li><code>deriv&lt;InterestDim&gt;()</code> to compute derivatives on the first or second dimension on a single coordinates only.</li>
<li><code>deriv_1_and_2()</code> to compute cross-derivatives n a single coordinates or fields of coordinates.</li>
<li><code>integrate()</code> to compute the integral on each pacth. The integral are stored in a <code>Kokkos::View</code> defined on host and of the same size as the number of patches.</li>
</ul>
<p><b>Warning:</b> The current version of <code><a class="el" href="classMultipatchSplineEvaluator2D.html" title="A class to evaluate all the splines of all the patches at once.">MultipatchSplineEvaluator2D</a></code> does not work on batched domain.</p>
<p><b>Warning:</b> The mappings applied in the given patch locator have to contain <code>operator()</code> from the logical domain to the physical domain and from the physical domain to the logical domain. Both operators are called in the <code><a class="el" href="classMultipatchSplineEvaluator2D.html" title="A class to evaluate all the splines of all the patches at once.">MultipatchSplineEvaluator2D</a></code> class to compute equivalent coordinates from one patch to another.</p>
<h1><a class="anchor" id="src_multipatch_spline__Multipatch_extrapolation_rules"></a>
Multipatch extrapolation rules</h1>
<p>To evaluate at a given coordinate outside of the domain, extrapolation rules have been implemented. They are declined according to the geometry:</p>
<ul>
<li><code><a class="el" href="structNullExtrapolationRule.html" title="Define null extrapolation rule commun to all geometries.">NullExtrapolationRule</a></code>: general for every geometries. It sets the values at zero for every coordinates outside of the domain.</li>
<li><code><a class="el" href="structConstantExtrapolationRuleOnion.html" title="Define constant extrapolation rule for onion shape geometries.">ConstantExtrapolationRuleOnion</a></code>: specialised for onion geometries (see <code><a class="el" href="classOnionPatchLocator.html" title="Patch locator specialised for &quot;onion&quot; geometry.">OnionPatchLocator</a></code> and <a class="el" href="src_multipatch_connectivity.html">Multipatch connectivity</a>). It calls <code>ddc::ConstantExtrapolationRule</code> to evaluate the outside coordinate. Two areas are considered as outside: with radius inferior to the minimum radius and with radius superior to the maximum radius.</li>
</ul>
<h1><a class="anchor" id="src_multipatch_spline__Contents"></a>
Contents</h1>
<ul>
<li><code><a class="el" href="constant__extrapolation__rules__onion_8hpp_source.html">constant_extrapolation_rules_onion.hpp</a></code>: Define <code><a class="el" href="structConstantExtrapolationRuleOnion.html" title="Define constant extrapolation rule for onion shape geometries.">ConstantExtrapolationRuleOnion</a></code>, constant extrapolation rule for onion geometries.</li>
<li><code><a class="el" href="multipatch__spline__builder__2d_8hpp_source.html">multipatch_spline_builder_2d.hpp</a></code>: Define the <code><a class="el" href="classMultipatchSplineBuilder2D.html" title="A class to call all the builders of all the patches once.">MultipatchSplineBuilder2D</a></code> operator to apply 2D spline builders on every patches.</li>
<li><code><a class="el" href="multipatch__spline__builder_8hpp_source.html">multipatch_spline_builder.hpp</a></code>: Define the <code><a class="el" href="classMultipatchSplineBuilder.html" title="A class to call all the builders of all the patches once.">MultipatchSplineBuilder</a></code> operator to apply 1D spline builders on every patches.</li>
<li><code><a class="el" href="multipatch__spline__evaluator__2d_8hpp_source.html">multipatch_spline_evaluator_2d.hpp</a></code>: Define the <code><a class="el" href="classMultipatchSplineEvaluator2D.html" title="A class to evaluate all the splines of all the patches at once.">MultipatchSplineEvaluator2D</a></code> operator to apply 2D spline evaluators on every patches.</li>
<li><code><a class="el" href="null__extrapolation__rules_8hpp_source.html">null_extrapolation_rules.hpp</a></code>: Define <code><a class="el" href="structNullExtrapolationRule.html" title="Define null extrapolation rule commun to all geometries.">NullExtrapolationRule</a></code>, a null extrapolation rule for every geometries. <br  />
 </li>
</ul>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
