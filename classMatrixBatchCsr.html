<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Gyselalib++: MatrixBatchCsr&lt; ExecSpace, Solver &gt; Class Template Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="logo.png"/></td>
  <td id="projectalign">
   <div id="projectname">Gyselalib++
   </div>
  </td>
    <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <span id="MSearchSelect"                onmouseover="return searchBox.OnSearchSelectShow()"                onmouseout="return searchBox.OnSearchSelectHide()">&#160;</span>
          <input type="text" id="MSearchField" value="" placeholder="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('classMatrixBatchCsr.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="classMatrixBatchCsr-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">MatrixBatchCsr&lt; ExecSpace, Solver &gt; Class Template Reference</div></div>
</div><!--header-->
<div class="contents">

<p><a class="el" href="classMatrix.html" title="The super class from which matrix classes should inherit.">Matrix</a> class which is able to manage and solve a batch of sparse linear systems.  
 <a href="classMatrixBatchCsr.html#details">More...</a></p>
<div class="dynheader">
Inheritance diagram for MatrixBatchCsr&lt; ExecSpace, Solver &gt;:</div>
<div class="dyncontent">
 <div class="center">
  <img src="classMatrixBatchCsr.png" usemap="#MatrixBatchCsr_3C_20ExecSpace_2C_20Solver_20_3E_map" alt=""/>
  <map id="MatrixBatchCsr_3C_20ExecSpace_2C_20Solver_20_3E_map" name="MatrixBatchCsr_3C_20ExecSpace_2C_20Solver_20_3E_map">
<area href="classMatrixBatch.html" title="MatrixBatch superclass for managing a collection of linear systems." alt="MatrixBatch&lt; ExecSpace &gt;" shape="rect" coords="0,0,233,24"/>
  </map>
</div></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a3b7820a5bd67452226c742f08cf37544" id="r_a3b7820a5bd67452226c742f08cf37544"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMatrixBatchCsr.html#a3b7820a5bd67452226c742f08cf37544">MatrixBatchCsr</a> (const int <a class="el" href="classMatrixBatch.html#a4ca6fc98c1b218c3aa0a534d04b2a06a">batch_size</a>, const int mat_size, const int nnz_per_system, std::optional&lt; int &gt; max_iter=std::nullopt, std::optional&lt; double &gt; res_tol=std::nullopt, std::optional&lt; bool &gt; logger=std::nullopt, std::optional&lt; int &gt; preconditionner_max_block_size=1u)</td></tr>
<tr class="memdesc:a3b7820a5bd67452226c742f08cf37544"><td class="mdescLeft">&#160;</td><td class="mdescRight">The constructor for <a class="el" href="classMatrixBatchCsr.html" title="Matrix class which is able to manage and solve a batch of sparse linear systems.">MatrixBatchCsr</a> class.  <br /></td></tr>
<tr class="separator:a3b7820a5bd67452226c742f08cf37544"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeb35ced3575736b99178638e1a21aa71" id="r_aeb35ced3575736b99178638e1a21aa71"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMatrixBatchCsr.html#aeb35ced3575736b99178638e1a21aa71">MatrixBatchCsr</a> (Kokkos::View&lt; double **, Kokkos::LayoutRight, ExecSpace &gt; batch_values, Kokkos::View&lt; int *, Kokkos::LayoutRight, ExecSpace &gt; cols_idx, Kokkos::View&lt; int *, Kokkos::LayoutRight, ExecSpace &gt; nnz_per_row, std::optional&lt; int &gt; max_iter=std::nullopt, std::optional&lt; double &gt; res_tol=std::nullopt, std::optional&lt; bool &gt; logger=std::nullopt, std::optional&lt; int &gt; preconditionner_max_block_size=1u)</td></tr>
<tr class="memdesc:aeb35ced3575736b99178638e1a21aa71"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor for <a class="el" href="classMatrixBatchCsr.html" title="Matrix class which is able to manage and solve a batch of sparse linear systems.">MatrixBatchCsr</a> class.  <br /></td></tr>
<tr class="separator:aeb35ced3575736b99178638e1a21aa71"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a06d8671618226f37e29927733d416b7b" id="r_a06d8671618226f37e29927733d416b7b"><td class="memItemLeft" align="right" valign="top">std::tuple&lt; Kokkos::View&lt; double **, Kokkos::LayoutRight, ExecSpace &gt;, Kokkos::View&lt; int *, Kokkos::LayoutRight, ExecSpace &gt;, Kokkos::View&lt; int *, Kokkos::LayoutRight, ExecSpace &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMatrixBatchCsr.html#a06d8671618226f37e29927733d416b7b">get_batch_csr</a> ()</td></tr>
<tr class="memdesc:a06d8671618226f37e29927733d416b7b"><td class="mdescLeft">&#160;</td><td class="mdescRight">A function to update information about values,indices and the number of non-zero per row for the whole batch.  <br /></td></tr>
<tr class="separator:a06d8671618226f37e29927733d416b7b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad037e66bbdfdfa674e678f49d36f78df" id="r_ad037e66bbdfdfa674e678f49d36f78df"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMatrixBatchCsr.html#ad037e66bbdfdfa674e678f49d36f78df">setup_solver</a> () final</td></tr>
<tr class="memdesc:ad037e66bbdfdfa674e678f49d36f78df"><td class="mdescLeft">&#160;</td><td class="mdescRight">Perform a pre-process operation on the solver.  <br /></td></tr>
<tr class="separator:ad037e66bbdfdfa674e678f49d36f78df"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5d7f76fc2c25fb4867b50181779b4c3c" id="r_a5d7f76fc2c25fb4867b50181779b4c3c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMatrixBatchCsr.html#a5d7f76fc2c25fb4867b50181779b4c3c">solve</a> (<a class="el" href="classMatrixBatch.html#aaefa005779305b357172ff993db97030">BatchedRHS</a> const b) const final</td></tr>
<tr class="memdesc:a5d7f76fc2c25fb4867b50181779b4c3c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Solve the batched linear problem Ax=b.  <br /></td></tr>
<tr class="separator:a5d7f76fc2c25fb4867b50181779b4c3c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5d3b37df4fa1caf358a4f08a7ae08865" id="r_a5d3b37df4fa1caf358a4f08a7ae08865"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMatrixBatchCsr.html#a5d3b37df4fa1caf358a4f08a7ae08865">solve</a> (<a class="el" href="classMatrixBatch.html#aaefa005779305b357172ff993db97030">BatchedRHS</a> const x, <a class="el" href="classMatrixBatch.html#aaefa005779305b357172ff993db97030">BatchedRHS</a> const b) const</td></tr>
<tr class="memdesc:a5d3b37df4fa1caf358a4f08a7ae08865"><td class="mdescLeft">&#160;</td><td class="mdescRight">Solve the batched linear problem Ax=b.  <br /></td></tr>
<tr class="separator:a5d3b37df4fa1caf358a4f08a7ae08865"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6eca63a806974a62a376ae271d6fb14d" id="r_a6eca63a806974a62a376ae271d6fb14d"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMatrixBatchCsr.html#a6eca63a806974a62a376ae271d6fb14d">norm</a> (int batch_idx) const</td></tr>
<tr class="memdesc:a6eca63a806974a62a376ae271d6fb14d"><td class="mdescLeft">&#160;</td><td class="mdescRight">A function returning the norm of a matrix located at batch_idx.  <br /></td></tr>
<tr class="separator:a6eca63a806974a62a376ae271d6fb14d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classMatrixBatch"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classMatrixBatch')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="classMatrixBatch.html">MatrixBatch&lt; ExecSpace &gt;</a></td></tr>
<tr class="memitem:ad51f64ea5ba9ccd34f7bb1aa2993f547 inherit pub_methods_classMatrixBatch" id="r_ad51f64ea5ba9ccd34f7bb1aa2993f547"><td class="memItemLeft" align="right" valign="top">
virtual&#160;</td><td class="memItemRight" valign="bottom"><b>~MatrixBatch</b> ()=default</td></tr>
<tr class="memdesc:ad51f64ea5ba9ccd34f7bb1aa2993f547 inherit pub_methods_classMatrixBatch"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destruct. <br /></td></tr>
<tr class="separator:ad51f64ea5ba9ccd34f7bb1aa2993f547 inherit pub_methods_classMatrixBatch"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a62a55966b021f64906841fb38764dbc0 inherit pub_methods_classMatrixBatch" id="r_a62a55966b021f64906841fb38764dbc0"><td class="memItemLeft" align="right" valign="top">std::size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMatrixBatch.html#a62a55966b021f64906841fb38764dbc0">size</a> () const</td></tr>
<tr class="memdesc:a62a55966b021f64906841fb38764dbc0 inherit pub_methods_classMatrixBatch"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the size of the square matrix corresponding to a single batch in one of its dimensions.  <br /></td></tr>
<tr class="separator:a62a55966b021f64906841fb38764dbc0 inherit pub_methods_classMatrixBatch"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4ca6fc98c1b218c3aa0a534d04b2a06a inherit pub_methods_classMatrixBatch" id="r_a4ca6fc98c1b218c3aa0a534d04b2a06a"><td class="memItemLeft" align="right" valign="top">std::size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMatrixBatch.html#a4ca6fc98c1b218c3aa0a534d04b2a06a">batch_size</a> () const</td></tr>
<tr class="memdesc:a4ca6fc98c1b218c3aa0a534d04b2a06a inherit pub_methods_classMatrixBatch"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the batch size of the linear problem.  <br /></td></tr>
<tr class="separator:a4ca6fc98c1b218c3aa0a534d04b2a06a inherit pub_methods_classMatrixBatch"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="inherited" name="inherited"></a>
Additional Inherited Members</h2></td></tr>
<tr class="inherit_header pub_types_classMatrixBatch"><td colspan="2" onclick="javascript:toggleInherit('pub_types_classMatrixBatch')"><img src="closed.png" alt="-"/>&#160;Public Types inherited from <a class="el" href="classMatrixBatch.html">MatrixBatch&lt; ExecSpace &gt;</a></td></tr>
<tr class="memitem:aaefa005779305b357172ff993db97030 inherit pub_types_classMatrixBatch" id="r_aaefa005779305b357172ff993db97030"><td class="memItemLeft" align="right" valign="top">
using&#160;</td><td class="memItemRight" valign="bottom"><b>BatchedRHS</b> = Kokkos::View&lt; double **, Kokkos::LayoutRight, ExecSpace &gt;</td></tr>
<tr class="memdesc:aaefa005779305b357172ff993db97030 inherit pub_types_classMatrixBatch"><td class="mdescLeft">&#160;</td><td class="mdescRight">The type of a Kokkos::View storing batched right-hand sides. Second dimension is batch dimension. <br /></td></tr>
<tr class="separator:aaefa005779305b357172ff993db97030 inherit pub_types_classMatrixBatch"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pro_methods_classMatrixBatch"><td colspan="2" onclick="javascript:toggleInherit('pro_methods_classMatrixBatch')"><img src="closed.png" alt="-"/>&#160;Protected Member Functions inherited from <a class="el" href="classMatrixBatch.html">MatrixBatch&lt; ExecSpace &gt;</a></td></tr>
<tr class="memitem:aa36e5c69da8c424b977aae7ac390715c inherit pro_methods_classMatrixBatch" id="r_aa36e5c69da8c424b977aae7ac390715c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMatrixBatch.html#aa36e5c69da8c424b977aae7ac390715c">MatrixBatch</a> (const std::size_t <a class="el" href="classMatrixBatch.html#a4ca6fc98c1b218c3aa0a534d04b2a06a">batch_size</a>, const std::size_t mat_size)</td></tr>
<tr class="memdesc:aa36e5c69da8c424b977aae7ac390715c inherit pro_methods_classMatrixBatch"><td class="mdescLeft">&#160;</td><td class="mdescRight">The constructor for <a class="el" href="classMatrixBatch.html" title="MatrixBatch superclass for managing a collection of linear systems.">MatrixBatch</a> class.  <br /></td></tr>
<tr class="separator:aa36e5c69da8c424b977aae7ac390715c inherit pro_methods_classMatrixBatch"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><div class="compoundTemplParams">template&lt;class ExecSpace, MatrixBatchCsrSolver Solver = MatrixBatchCsrSolver::BICGSTAB&gt;<br />
class MatrixBatchCsr&lt; ExecSpace, Solver &gt;</div><p><a class="el" href="classMatrix.html" title="The super class from which matrix classes should inherit.">Matrix</a> class which is able to manage and solve a batch of sparse linear systems. </p>
<p>Executes on either CPU or GPU. It takes advantage of the sparse structure, and the only batched solver available in Ginkgo : Stabilised Bicg. This class uses the CSR storage format which needs three arrays, one stores values, the other column indices. The third array contains the count of non-zero inside the matrix lines.(eg:for a given line index i nn_per_row[i]= sum of non-zeros until line i) The class returns these arrays (as Kokkos views) with the get_csr_views function, it is then possible to fill them outside the class. The sparsity pattern is the same for all matrices, hence column indices are stored only for one system. Tolerance and maximal number of iterations, which are parameters for the iterative solver, are set in the constructor. It is possible to get convergence information by activating the logger at constructor call. </p><dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">ExecSpace</td><td>Execution space,needed by Kokkos for allocations and parallelism. The simplest choice is to follow Kokkos, for that: specify Kokkos::DefaultExecutionSpace </td></tr>
    <tr><td class="paramname">Solver</td><td>Refers to the solver type, default value is the Bicgstab which is more general. The use of a CG solver is also possible, in this case, please make sure that matrices structure fulfils CG requirements. </td></tr>
  </table>
  </dd>
</dl>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a3b7820a5bd67452226c742f08cf37544" name="a3b7820a5bd67452226c742f08cf37544"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3b7820a5bd67452226c742f08cf37544">&#9670;&#160;</a></span>MatrixBatchCsr() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class ExecSpace , MatrixBatchCsrSolver Solver = MatrixBatchCsrSolver::BICGSTAB&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classMatrixBatchCsr.html">MatrixBatchCsr</a>&lt; ExecSpace, Solver &gt;<a class="el" href="classMatrixBatchCsr.html">::MatrixBatchCsr</a> </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>batch_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>mat_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>nnz_per_system</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::optional&lt; int &gt;&#160;</td>
          <td class="paramname"><em>max_iter</em> = <code>std::nullopt</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::optional&lt; double &gt;&#160;</td>
          <td class="paramname"><em>res_tol</em> = <code>std::nullopt</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::optional&lt; bool &gt;&#160;</td>
          <td class="paramname"><em>logger</em> = <code>std::nullopt</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::optional&lt; int &gt;&#160;</td>
          <td class="paramname"><em>preconditionner_max_block_size</em> = <code>1u</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">explicit</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The constructor for <a class="el" href="classMatrixBatchCsr.html" title="Matrix class which is able to manage and solve a batch of sparse linear systems.">MatrixBatchCsr</a> class. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">batch_size</td><td>Number of linear systems to solve. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mat_size</td><td>Common matrix size for all the systems. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nnz_per_system</td><td>Number of non-zero components per matrix. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">max_iter</td><td>maximal number of iterations for the solver, default 1000. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">res_tol</td><td>residual tolerance parameter, to ensure convergence. Be careful! the relative residual provided here, will be used as "implicit residual" in ginkgo solver. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">logger</td><td>boolean parameter for saving log information such residual and interactions count. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">preconditionner_max_block_size</td><td>An optional parameter used to define the maximum size of a block </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="aeb35ced3575736b99178638e1a21aa71" name="aeb35ced3575736b99178638e1a21aa71"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeb35ced3575736b99178638e1a21aa71">&#9670;&#160;</a></span>MatrixBatchCsr() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class ExecSpace , MatrixBatchCsrSolver Solver = MatrixBatchCsrSolver::BICGSTAB&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classMatrixBatchCsr.html">MatrixBatchCsr</a>&lt; ExecSpace, Solver &gt;<a class="el" href="classMatrixBatchCsr.html">::MatrixBatchCsr</a> </td>
          <td>(</td>
          <td class="paramtype">Kokkos::View&lt; double **, Kokkos::LayoutRight, ExecSpace &gt;&#160;</td>
          <td class="paramname"><em>batch_values</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Kokkos::View&lt; int *, Kokkos::LayoutRight, ExecSpace &gt;&#160;</td>
          <td class="paramname"><em>cols_idx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Kokkos::View&lt; int *, Kokkos::LayoutRight, ExecSpace &gt;&#160;</td>
          <td class="paramname"><em>nnz_per_row</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::optional&lt; int &gt;&#160;</td>
          <td class="paramname"><em>max_iter</em> = <code>std::nullopt</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::optional&lt; double &gt;&#160;</td>
          <td class="paramname"><em>res_tol</em> = <code>std::nullopt</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::optional&lt; bool &gt;&#160;</td>
          <td class="paramname"><em>logger</em> = <code>std::nullopt</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::optional&lt; int &gt;&#160;</td>
          <td class="paramname"><em>preconditionner_max_block_size</em> = <code>1u</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">explicit</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Constructor for <a class="el" href="classMatrixBatchCsr.html" title="Matrix class which is able to manage and solve a batch of sparse linear systems.">MatrixBatchCsr</a> class. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">batch_values</td><td>A 2D Kokkos view which stores the values of non-zero elements for the whole batch. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">cols_idx</td><td>A 1D Kokkos view which stores the column indices for each non-zero component.(only for one matrix) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nnz_per_row</td><td>A 1D Kokkos view of length matrix_size+1 which stores the count of the non-zeros along the lines of the matrix. It is defined as: nnz_per_row[0] = 0. nnz_per_row[matrix_size] = total_number_of_nonzero. To get the number of non-zero for a line i,one have to compute : n_non_zeros_at_line_in = nnz_per_row[i+1]-nnz_per_row[i]. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">max_iter</td><td>maximal number of iterations for the solver, default 1000. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">res_tol</td><td>residual tolerance parameter, to ensure convergence. Be careful! The residual provided here, set as relative residual, will be used as "implicit residual" in ginkgo solver. Default value is set to 1e-15. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">logger</td><td>boolean parameter to save logger information. Default value false. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">preconditionner_max_block_size</td><td>An optional parameter used to define the maximum size of a block </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a06d8671618226f37e29927733d416b7b" name="a06d8671618226f37e29927733d416b7b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a06d8671618226f37e29927733d416b7b">&#9670;&#160;</a></span>get_batch_csr()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class ExecSpace , MatrixBatchCsrSolver Solver = MatrixBatchCsrSolver::BICGSTAB&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::tuple&lt; Kokkos::View&lt; double **, Kokkos::LayoutRight, ExecSpace &gt;, Kokkos::View&lt; int *, Kokkos::LayoutRight, ExecSpace &gt;, Kokkos::View&lt; int *, Kokkos::LayoutRight, ExecSpace &gt; &gt; <a class="el" href="classMatrixBatchCsr.html">MatrixBatchCsr</a>&lt; ExecSpace, Solver &gt;::get_batch_csr </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>A function to update information about values,indices and the number of non-zero per row for the whole batch. </p>
<p>Data is managed by Kokkos Views stored on the host. </p><dl class="section return"><dt>Returns</dt><dd>vals_view A 2D Kokkos view which stores the values of non-zero elements for the whole batch. </dd>
<dd>
col_idx_view A 1D Kokkos view which stores the column indices for each non-zero component.(only for one matrix) </dd>
<dd>
nnz_per_row_view A 1D Kokkos view which stores the count of non-zero per line, in an additive way. see nnz_per_row parameter in constructor. </dd></dl>

</div>
</div>
<a id="ad037e66bbdfdfa674e678f49d36f78df" name="ad037e66bbdfdfa674e678f49d36f78df"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad037e66bbdfdfa674e678f49d36f78df">&#9670;&#160;</a></span>setup_solver()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class ExecSpace , MatrixBatchCsrSolver Solver = MatrixBatchCsrSolver::BICGSTAB&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classMatrixBatchCsr.html">MatrixBatchCsr</a>&lt; ExecSpace, Solver &gt;::setup_solver </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">final</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Perform a pre-process operation on the solver. </p>
<p>Must be called after filling the matrix.</p>
<p>It uses the batch of matrices to generate a batched Jacobi preconditioner. Other parameters like maximum number of iterations and tolerance are also used to instantiate a Ginkgo solver.</p>
<p>The stopping criterion is a reduction factor ||Ax-b||/||b||&lt;tol with max_iter maximum iterations. </p>

<p>Implements <a class="el" href="classMatrixBatch.html#a9d2068033157c94e632788300a43c884">MatrixBatch&lt; ExecSpace &gt;</a>.</p>

</div>
</div>
<a id="a5d7f76fc2c25fb4867b50181779b4c3c" name="a5d7f76fc2c25fb4867b50181779b4c3c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5d7f76fc2c25fb4867b50181779b4c3c">&#9670;&#160;</a></span>solve() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class ExecSpace , MatrixBatchCsrSolver Solver = MatrixBatchCsrSolver::BICGSTAB&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classMatrixBatchCsr.html">MatrixBatchCsr</a>&lt; ExecSpace, Solver &gt;::solve </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMatrixBatch.html#aaefa005779305b357172ff993db97030">BatchedRHS</a> const&#160;</td>
          <td class="paramname"><em>b</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">final</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Solve the batched linear problem Ax=b. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">b</td><td>A 2D Kokkos::View storing the batched right-hand sides of the problem and receiving the corresponding solutions. </td></tr>
  </table>
  </dd>
</dl>

<p>Implements <a class="el" href="classMatrixBatch.html#aed90bf340060a7bc8c24cf61771e212e">MatrixBatch&lt; ExecSpace &gt;</a>.</p>

</div>
</div>
<a id="a5d3b37df4fa1caf358a4f08a7ae08865" name="a5d3b37df4fa1caf358a4f08a7ae08865"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5d3b37df4fa1caf358a4f08a7ae08865">&#9670;&#160;</a></span>solve() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class ExecSpace , MatrixBatchCsrSolver Solver = MatrixBatchCsrSolver::BICGSTAB&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classMatrixBatchCsr.html">MatrixBatchCsr</a>&lt; ExecSpace, Solver &gt;::solve </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMatrixBatch.html#aaefa005779305b357172ff993db97030">BatchedRHS</a> const&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMatrixBatch.html#aaefa005779305b357172ff993db97030">BatchedRHS</a> const&#160;</td>
          <td class="paramname"><em>b</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Solve the batched linear problem Ax=b. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">x</td><td>A 2D Kokkos::View storing the batched initial guests (useful for iterative solver) of the problems, and receiving the corresponding solutions.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">b</td><td>A 2D Kokkos::View storing the batched right-hand side of the problems. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a6eca63a806974a62a376ae271d6fb14d" name="a6eca63a806974a62a376ae271d6fb14d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6eca63a806974a62a376ae271d6fb14d">&#9670;&#160;</a></span>norm()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class ExecSpace , MatrixBatchCsrSolver Solver = MatrixBatchCsrSolver::BICGSTAB&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double <a class="el" href="classMatrixBatchCsr.html">MatrixBatchCsr</a>&lt; ExecSpace, Solver &gt;::norm </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>batch_idx</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>A function returning the norm of a matrix located at batch_idx. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">batch_idx</td><td>The index of the matrix in the batch. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The value of the matrix infinite-norm. </dd></dl>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>/home/runner/work/gyselalibxx/gyselalibxx/code_branch/src/matrix_tools/<a class="el" href="matrix__batch__csr_8hpp_source.html">matrix_batch_csr.hpp</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="classMatrixBatchCsr.html">MatrixBatchCsr</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
