<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../../../img/favicon.ico" />
    <title>Multipatch connectivity - GyselalibX</title>
    <link rel="stylesheet" href="../../../css/theme.css" />
    <link rel="stylesheet" href="../../../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Multipatch connectivity";
        var mkdocs_page_input_path = "src/multipatch/connectivity/README.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../../../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../../.." class="icon icon-home"> GyselalibX
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption"><span class="caption-text">General</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../../index.html">Home</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >First Steps</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../../docs/first_steps/getting_started.html">Getting Started</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" >Installation</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../../../docs/first_steps/install.html">Gyselalib++ Installation</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../../toolchains/index.html">Pre-made build settings</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../docs/first_steps/DDC_in_gyselalibxx.html">DDC in Gyselalib++</a>
                </li>
    </ul>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Standards</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../../docs/standards/CODING_STANDARD.html">Coding Standard</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../docs/standards/mathematical_and_physical_conventions.html">Math & Physics</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Gyselalib++</span></p>
              <ul class="current">
                  <li class="toctree-l1 current"><a class="reference internal current" >Source</a>
    <ul class="current">
                <li class="toctree-l2"><a class="reference internal" href="../../index.html">Gyselalib++ contents</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" >advection</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../../advection/index.html">Advection methods</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" >collisions</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../../collisions/index.html">Collisions</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" >data_types</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../../data_types/index.html">Data Storage Types</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" >geometryRTheta</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../../geometryRTheta/index.html">Geometry (r, theta)</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" >advection</a>
    <ul>
                <li class="toctree-l4"><a class="reference internal" href="../../geometryRTheta/advection/index.html">Advection operator</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l3"><a class="reference internal" >advection_field</a>
    <ul>
                <li class="toctree-l4"><a class="reference internal" href="../../geometryRTheta/advection_field/index.html">Advection Field finder</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l3"><a class="reference internal" >geometry</a>
    <ul>
                <li class="toctree-l4"><a class="reference internal" href="../../geometryRTheta/geometry/index.html">Geometry RTheta</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l3"><a class="reference internal" >initialisation</a>
    <ul>
                <li class="toctree-l4"><a class="reference internal" href="../../geometryRTheta/initialisation/index.html">Initialisation</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l3"><a class="reference internal" >poisson</a>
    <ul>
                <li class="toctree-l4"><a class="reference internal" href="../../geometryRTheta/poisson/index.html">Polar Poisson solver</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l3"><a class="reference internal" >time_solver</a>
    <ul>
                <li class="toctree-l4"><a class="reference internal" href="../../geometryRTheta/time_solver/index.html">Predictor-corrector methods</a>
                </li>
    </ul>
                </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" >geometryVparMu</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../../geometryVparMu/index.html">Geometry (vpar, mu)</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" >collisions</a>
    <ul>
                <li class="toctree-l4"><a class="reference internal" href="../../geometryVparMu/collisions/index.html">CollisionConfiguration</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l3"><a class="reference internal" >geometry</a>
    <ul>
                <li class="toctree-l4"><a class="reference internal" href="../../geometryVparMu/geometry/index.html">GeometryVparMu</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l3"><a class="reference internal" >initialisation</a>
    <ul>
                <li class="toctree-l4"><a class="reference internal" href="../../geometryVparMu/initialisation/index.html">Initialisation methods</a>
                </li>
    </ul>
                </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" >geometryXVx</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../../geometryXVx/index.html">Geometry (x, v_x)</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" >boltzmann</a>
    <ul>
                <li class="toctree-l4"><a class="reference internal" href="../../geometryXVx/boltzmann/index.html">Boltzmann solver</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l3"><a class="reference internal" >geometry</a>
    <ul>
                <li class="toctree-l4"><a class="reference internal" href="../../geometryXVx/geometry/index.html">Geometry X-Vx</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l3"><a class="reference internal" >initialisation</a>
    <ul>
                <li class="toctree-l4"><a class="reference internal" href="../../geometryXVx/initialisation/index.html">Initialisation methods</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l3"><a class="reference internal" >poisson</a>
    <ul>
                <li class="toctree-l4"><a class="reference internal" href="../../geometryXVx/poisson/index.html">Quasi-Neutrality Solver</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l3"><a class="reference internal" >rhs</a>
    <ul>
                <li class="toctree-l4"><a class="reference internal" href="../../geometryXVx/rhs/index.html">RHS</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l3"><a class="reference internal" >time_integration</a>
    <ul>
                <li class="toctree-l4"><a class="reference internal" href="../../geometryXVx/time_integration/index.html">Time integration</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l3"><a class="reference internal" >utils</a>
    <ul>
                <li class="toctree-l4"><a class="reference internal" href="../../geometryXVx/utils/index.html">Utils</a>
                </li>
    </ul>
                </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" >geometryXY</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../../geometryXY/index.html">Geometry (x, y)</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" >geometry</a>
    <ul>
                <li class="toctree-l4"><a class="reference internal" href="../../geometryXY/geometry/index.html">Geometry XY</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l3"><a class="reference internal" >initialisation</a>
    <ul>
                <li class="toctree-l4"><a class="reference internal" href="../../geometryXY/initialisation/index.html">Initialisation on (x,y) geometry</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l3"><a class="reference internal" >time_integration</a>
    <ul>
                <li class="toctree-l4"><a class="reference internal" href="../../geometryXY/time_integration/index.html">Predictor-corrector methods</a>
                </li>
    </ul>
                </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" >geometryXYVxVy</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../../geometryXYVxVy/index.html">Geometry (x, y, v_x, v_y)</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" >geometry</a>
    <ul>
                <li class="toctree-l4"><a class="reference internal" href="../../geometryXYVxVy/geometry/index.html">Geometry X Y-Vx Vy</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l3"><a class="reference internal" >initialisation</a>
    <ul>
                <li class="toctree-l4"><a class="reference internal" href="../../geometryXYVxVy/initialisation/index.html">Initialisation methods</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l3"><a class="reference internal" >poisson</a>
    <ul>
                <li class="toctree-l4"><a class="reference internal" href="../../geometryXYVxVy/poisson/index.html">Quasi-Neutrality Solver</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l3"><a class="reference internal" >time_integration</a>
    <ul>
                <li class="toctree-l4"><a class="reference internal" href="../../geometryXYVxVy/time_integration/index.html">Time integration</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l3"><a class="reference internal" >vlasov</a>
    <ul>
                <li class="toctree-l4"><a class="reference internal" href="../../geometryXYVxVy/vlasov/index.html">Vlasov solver</a>
                </li>
    </ul>
                </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" >interpolation</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../../interpolation/index.html">Interpolation Methods</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" >polar_splines</a>
    <ul>
                <li class="toctree-l4"><a class="reference internal" href="../../interpolation/polar_splines/index.html">Polar Splines</a>
                </li>
    </ul>
                </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" >io</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../../io/index.html">Functions used for input and output</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" >mapping</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../../mapping/index.html">Mappings</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" >math_tools</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../../math_tools/index.html">Utility Functions</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" >matrix_tools</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../../matrix_tools/index.html">Matrix tools</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" >mpi_parallelisation</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../../mpi_parallelisation/index.html">Parallelisation</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l2 current"><a class="reference internal current" >multipatch</a>
    <ul class="current">
                <li class="toctree-l3"><a class="reference internal" href="../index.html">Multipatch</a>
                </li>
                <li class="toctree-l3 current"><a class="reference internal current" >connectivity</a>
    <ul class="current">
                <li class="toctree-l4 current"><a class="reference internal current" href="#">Multipatch connectivity</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l3"><a class="reference internal" >data_types</a>
    <ul>
                <li class="toctree-l4"><a class="reference internal" href="../data_types/index.html">Data Types for Multipatch Geometry</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l3"><a class="reference internal" >spline</a>
    <ul>
                <li class="toctree-l4"><a class="reference internal" href="../spline/index.html">Spline on multipatch geometry</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l3"><a class="reference internal" >utils</a>
    <ul>
                <li class="toctree-l4"><a class="reference internal" href="../utils/index.html">Multipatch utilitary functions</a>
                </li>
    </ul>
                </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" >pde_solvers</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../../pde_solvers/index.html">PDE Solvers</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" >quadrature</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../../quadrature/index.html">Quadrature Methods</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" >speciesinfo</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../../speciesinfo/index.html">SpeciesInfo (x, v_x)</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" >timestepper</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../../timestepper/index.html">Time Stepping Methods</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" >utils</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../../utils/index.html">Utility Functions</a>
                </li>
    </ul>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Simulations</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../../simulations/index.html">Gyselalib++ simulations</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" >geometryRTheta</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../../../simulations/geometryRTheta/index.html">Simulations in (r, theta) geometry</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" >diocotron</a>
    <ul>
                <li class="toctree-l4"><a class="reference internal" href="../../../simulations/geometryRTheta/diocotron/index.html">Diocotron instability</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l3"><a class="reference internal" >vortex_merger</a>
    <ul>
                <li class="toctree-l4"><a class="reference internal" href="../../../simulations/geometryRTheta/vortex_merger/index.html">Vortex merger</a>
                </li>
    </ul>
                </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" >geometryXVx</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../../../simulations/geometryXVx/index.html">Simulations in (x, vx) geometry</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" >geometryXY</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../../../simulations/geometryXY/index.html">Simulations in (x, y) geometry</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" >guiding_centre</a>
    <ul>
                <li class="toctree-l4"><a class="reference internal" href="../../../simulations/geometryXY/guiding_centre/index.html">Guiding centre (X,Y) simulation</a>
                </li>
    </ul>
                </li>
    </ul>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Tests</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../../tests/index.html">Gyselalib++ tests</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" >advection</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../../../tests/advection/index.html">Tests on the templated advection operators</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" >geometryRTheta</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../../../tests/geometryRTheta/index.html">Tests : Geometry (r, theta)</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" >advection_rtheta</a>
    <ul>
                <li class="toctree-l4"><a class="reference internal" href="../../../tests/geometryRTheta/advection_rtheta/index.html">Tests on the 2D polar advection operator</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l3"><a class="reference internal" >polar_poisson</a>
    <ul>
                <li class="toctree-l4"><a class="reference internal" href="../../../tests/geometryRTheta/polar_poisson/index.html">Tests on the 2D polar poisson solver</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l3"><a class="reference internal" >spline_interpolator_rtheta</a>
    <ul>
                <li class="toctree-l4"><a class="reference internal" href="../../../tests/geometryRTheta/spline_interpolator_rtheta/index.html">Tests on spline interpolator in polar coordinates</a>
                </li>
    </ul>
                </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" >multipatch</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../../../tests/multipatch/index.html">Multipatch geometry tests</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" >geometries</a>
    <ul>
                <li class="toctree-l4"><a class="reference internal" href="../../../tests/multipatch/geometries/index.html">Multipatch geometries</a>
                </li>
    </ul>
                </li>
    </ul>
                </li>
    </ul>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Development</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../../docs/development/Adding_docs.html">Adding Docs</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../docs/development/Using_git.html">Using Git</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../docs/development/developer_FAQ.html">Developer FAQ</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Troubleshooting</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../../docs/troubleshooting/Common_compilation_problems.html">Compilation Issues</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">API</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" >Gyselalib++</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" >Classes</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../../../gyselalibxx/annotated.html">Class List</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../../gyselalibxx/classes.html">Class Index</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../../gyselalibxx/hierarchy.html">Class Hierarchy</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" >Namespaces</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../../../gyselalibxx/namespaces.html">Namespace List</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../../gyselalibxx/namespace_members.html">Namespace Members</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../../gyselalibxx/namespace_member_functions.html">Namespace Member Functions</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../../gyselalibxx/namespace_member_variables.html">Namespace Member Variables</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../../gyselalibxx/namespace_member_typedefs.html">Namespace Member Typedefs</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../../gyselalibxx/namespace_member_enums.html">Namespace Member Enumerations</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../gyselalibxx/functions.html">Functions</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../gyselalibxx/variables.html">Variables</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../gyselalibxx/macros.html">Macros</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../gyselalibxx/files.html">Files</a>
                </li>
    </ul>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../..">GyselalibX</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../.." class="icon icon-home" aria-label="Docs"></a></li>
          <li class="breadcrumb-item">Gyselalib++</li>
          <li class="breadcrumb-item">Source</li>
          <li class="breadcrumb-item">multipatch</li>
          <li class="breadcrumb-item">connectivity</li>
      <li class="breadcrumb-item active">Multipatch connectivity</li>
    <li class="wy-breadcrumbs-aside">
          <a href="https://github.com/gyselax/gyselalibxx/edit/main/src/multipatch/connectivity/README.md" class="icon icon-github"> Edit on GitHub</a>
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <div><h1 id="multipatch-connectivity">Multipatch connectivity</h1>
<p>This directory defines structures and methods to describe patches and how they are connected to one another.</p>
<p>The following sections describe the structures and methods implemented:</p>
<ul>
<li><a href="#patch">Patch</a> - Definition of Patch tag.</li>
<li><a href="#interfaces">Interfaces</a></li>
<li><a href="#sticking-of-two-edges">Sticking of Two Edges</a><ul>
<li><a href="#multi-patch-domain">Multi-patch domain</a> - Mathematical definition of multi-patch domain.</li>
<li><a href="#edges">Edges</a> - Mathematical definition of edges.</li>
<li><a href="#sticking-and-coordinate-transformation">Sticking and Coordinate Transformation</a> - Mathematical definition of  coordinate transformation and links to the implemented class (Interface, Edge and EdgeTransformation).</li>
<li><a href="#index-transformation">Index transformation</a> - Algorithm of the index transformation in EdgeTransformation.</li>
<li><a href="#conformity-of-the-meshes">Conformity of the meshes</a> - Definition of <code>UniformGridIdxMatching</code>.</li>
</ul>
</li>
<li><a href="#patch-locator">Patch locator</a> - Definition of patch locator operators to identify the patch where a given physical coordinate is.</li>
<li><a href="#onion-shaped-geometry">Onion shaped geometry</a> - Definition of <code>OnionPatchLocator</code>, a specialisation of <code>IPatchLocator</code> for "onion" shape geometries.  </li>
<li><a href="#references">References</a> - References.</li>
<li><a href="#contents">Contents</a> - List of files in the folder.</li>
</ul>
<h2 id="patch">Patch</h2>
<p>The tag Patch refers to a single 2D patch geometry. The tag contains aliases (or shortcuts) to the DDC geometry elements, such as:</p>
<ul>
<li>Grids (or points sequence along one dimension) on both dimensions (<code>Grid1</code> and <code>Grid2</code>);  </li>
<li>Associated continuous dimensions (<code>Dim1</code> and <code>Dim2</code>);  </li>
<li>Dimensions for B-splines coefficients (<code>Bsplines1</code> and <code>Bsplines2</code>);  </li>
<li>Coordinates of objects represented on the dimensions (<code>Coord1</code>, <code>Coord2</code> and <code>Coord12</code>);  </li>
<li>The type which describes the index of a grid point (e.g. <code>Idx1</code>);  </li>
<li>The type which describes a distance between grid points (e.g. <code>IdxStep1</code>);</li>
<li>The type which describes the index range of a grid (e.g. <code>IdxRange1</code>).</li>
<li>The type which describes the index range of a spline coefficients grid (e.g. <code>BSIdxRange1</code>).</li>
</ul>
<p>The domain defined on this patch is called <em>logical domain</em>.</p>
<h2 id="interfaces">Interfaces</h2>
<h3 id="sticking-of-two-edges">Sticking of Two Edges</h3>
<p>We follow the idea to represent the topology of a multipatch domain using
the idea of <em>domain manifolds</em> (see [1]). This means that we have several
independent tensor-product logical domains and define their sticking via coordinate
transformations.</p>
<p><strong>Remark:</strong> In the referenced paper, the authors use affine isometries of the entire
patch instead of coordinate transformations of the faces. This is equivalent to our approach in
the sense that, when the scaling of the domains is removed and we consider only
unit squares as logical domains, the coordinate transformations of the faces and the information
about which edges are identified determine the
isometries used in the paper and vice versa. This is easy to show.</p>
<h4 id="multi-patch-domain">Multi-patch domain</h4>
<p>For simplicity, we will constrain ourselves to the 2D case, but this approach
could be generalised to arbitrary dimensions.</p>
<p>Let <span class="arithmatex">\(\Omega\)</span> be the domain of interest and assume that we have patches <span class="arithmatex">\(\Omega^{(i)}\)</span>, <span class="arithmatex">\(i=1,...,K\)</span>, which are disjoint, s.t.</p>
<div class="arithmatex">\[
\Omega = \dot{\bigcup}_{i=1}^K \Omega^{(i)}.
\]</div>
<p>For every patch <span class="arithmatex">\(\Omega^{(i)}\)</span> we have a mapping</p>
<div class="arithmatex">\[
F^{(i)}: [a_x^{(i)}, b_x^{(i)}]\times[a_y^{(i)} b_y^{(i)}] \rightarrow \Omega^{(i)}, 
\]</div>
<p>where the rectangular domain <span class="arithmatex">\([a_x^{(i)}, b_x^{(i)}]\times[a_y^{(i)} b_y^{(i)}]\)</span> defines
the logical coordinates for the patch. We call this logical coordinate domain
the <em>logical patch</em>.</p>
<h4 id="edges">Edges</h4>
<p>So we obtain four logical edges</p>
<div class="arithmatex">\[
[a_x^{(i)}, b_x^{(i)}] \times \{ a_y^{(i)} \}, \quad
[a_x^{(i)}, b_x^{(i)}] \times \{ b_y^{(i)} \}, \quad
\{ a_x^{(i)} \} \times [a_y^{(i)}, b_y^{(i)}], \quad
\{ b_x^{(i)} \} \times [a_y^{(i)}, b_y^{(i)}] 
\]</div>
<p>In the code, we define edges as follows.
Every edge of a logical patch is identified via the patch it belongs to, the dimension
and whether it is at the front or the back of the domain.
So e.g.the edge <span class="arithmatex">\([a_x^{(i)}, b_x^{(i)}] \times \{ a_y^{(i)} \}\)</span> would be identified with patch <span class="arithmatex">\(i\)</span>, dimensions <code>Yi</code> and <code>FRONT</code>.
<span class="arithmatex">\([a_x^{(i)}, b_x^{(i)}] \times \{ b_y^{(i)} \}\)</span> would be identified with patch <span class="arithmatex">\(i\)</span>, dimensions <code>Yi</code> and <code>BACK</code> and
<span class="arithmatex">\(\{ b_x^{(i)} \} \times [a_y^{(i)}, b_y^{(i)}]\)</span> would be identified with patch <span class="arithmatex">\(i\)</span>, dimensions <code>Xi</code> and <code>BACK</code>.</p>
<h4 id="sticking-and-coordinate-transformation">Sticking and Coordinate Transformation</h4>
<p>Any edge can then be associated with an edge on another patch.
This corresponds to the 'sticking'.
So for a different patch <span class="arithmatex">\(\Omega^{(j)}\)</span>, we have the logical coordinate domain
<span class="arithmatex">\([a_x^{(j)}, b_x^{(j)}] \times [a_y^{(j)} b_y^{(j)}]\)</span>.
If we want to stick patch <span class="arithmatex">\(i\)</span> to patch <span class="arithmatex">\(j\)</span>, we have to determine the edges that
are identified and how they are identified.
The way that they are identified is mathematically determined via the coordinate transformation from one edge
to the other.
Since the transformations are supposed to be affine and bijective, there are only two options:
the transformation can be order preserving or
order reversing (this corresponds to the orientation of the physical edge where two parametrisations
coming from the two patches can have either the same or the opposite orientation respectively).</p>
<p>So for example, we want to stick the edge <span class="arithmatex">\(\{ a_x^{(i)} \} \times [a_y^{(i)}, b_y^{(i)}]\)</span>
on patch <span class="arithmatex">\(i\)</span> to the edge <span class="arithmatex">\([a_x^{(j)}, b_x^{(j)}] \times \{ b_y^{(j)} \}\)</span> on patch <span class="arithmatex">\(j\)</span>.
If the transformation is order-preserving (i.e. the orientations of the parametrisations
of the physical edge agree), then the transformation from the first edge to the second is</p>
<div class="arithmatex">\[
t \mapsto a_x^{(j)} + \frac{t - a_y^{(i)}}{b_y^{(i)} - a_y^{(i)}} \, (b_x^{(j)} - a_x^{(j)}).
\]</div>
<p>If the transformation is order-reversing (i.e. the orientations of the parametrisations
of the physical edge are opposite), then it is</p>
<div class="arithmatex">\[
t \mapsto b_x^{(j)} - \frac{t - a_y^{(i)}}{b_y^{(i)} - a_y^{(i)}} \, (b_x^{(j)} - a_x^{(j)}).
\]</div>
<p>In the code, an edge is represented by the <code>Edge</code> structure.
The sticking of two edges is represented by an <code>Interface</code> structure which contains tags
to the first patch and the second patch as well as the boolean member <code>orientations_agree</code>.
The transformation from one edge to the other is done using the <code>EdgeTransformation</code> operator.</p>
<p>This operator contains an <code>operator()</code> to transform a given coordinate on a coordinate on the other patch.
It has also been extended for indices.</p>
<h4 id="index-transformation">Index transformation</h4>
<p>All the patches are discretized into a finite number of points indexed by indices.
So each index refers to a coordinate on a patch.
For a given index on an edge of a patch at the interface, we can find an equivalent
index on the other patch. This is always true for conforming meshes but not always the
case for non-conforming meshes.</p>
<p>For non-conforming meshes, the method <code>is_match_available()</code> is needed to identify if the given
index has an equivalent or not. If <code>is_match_available()</code> returns true, we can then
call the <code>operator()</code> to get the equivalent index on the other patch.
Instead of calling both method, it is also possible to call <code>search_for_match()</code> which
returns true if there is an equivalent index and updates it the given target index.</p>
<p><strong>For uniform grids</strong> <span class="arithmatex">\(\{x_i\}_{i=0, ..., N}\)</span> (current grid)  and <span class="arithmatex">\(\{x_j\}_{j=0, ..., M}\)</span> (target grid),
finding an equivalent index can be done with the following steps:</p>
<ul>
<li>
<p>We compute the greatest common divisor of the number of cells <span class="arithmatex">\(N\)</span> and <span class="arithmatex">\(M\)</span>
(e.g. <span class="arithmatex">\(\exists \ gcd \in\mathbb{N}, gcd&gt;1; \ M \wedge N = gcd\)</span>).</p>
</li>
<li>
<p>The current index <span class="arithmatex">\(k\)</span> can have an equivalent index on the target patch.</p>
</li>
</ul>
<p>Depending on if <span class="arithmatex">\(k / p \in \mathbb{N}^*\)</span> with <span class="arithmatex">\(p = \frac{N}{gcd} \in \mathbb{N}^*\)</span>,
this equivalent is given by multiplying by <span class="arithmatex">\(\frac{M}{N}\)</span> and adapt if the coordinate transformation is not order-preserving.</p>
<ul>
<li>If the greatest common divisor is <span class="arithmatex">\(1\)</span>, there is no equivalent index except for the first and last indices.</li>
</ul>
<p><strong>For non-uniform grids</strong>, we cannot use this algorithm. We check all the indices of the target patch if
one of them fit with the current one.
We can use dichotomy method for the search.</p>
<h4 id="conformity-of-the-meshes">Conformity of the meshes</h4>
<p>When there are non-conforming meshes, some operators need to loop on the "conforming indexes" at each Interface,
i.e. the indexes with an equivalent index on the other patch of the interface.</p>
<p>The <code>UniformIdxStepIndexMatching</code> storage class stores for a given Interface the "conforming indexes" in an IdxRangeSlice for each patch.
Currently, the IdxRangeSlice stores indexes from an IdxRange with regular index steps.
So the <code>UniformIdxStepIndexMatching</code> class does the same, and triggers assert when the conformity between two edges is not
uniform.</p>
<p>For example, <code>UniformIdxStepIndexMatching</code> is adapted to this type of interface</p>
<pre><code class="language-none">    0   1   2   3   4   5   6   7   8       &lt;- Edge1
    |   |   |   |   |   |   |   |   |
       -2-     -2-     -2-     -2-          &lt;- The index steps are regular. 
       -1-     -1-     -1-     -1-          &lt;- The index steps are regular. 
    |       |       |       |       |
    0       1       2       3       4       &lt;- Edge2
</code></pre>
<p>but fails for this type of interface</p>
<pre><code class="language-none">    0   1   2   3   4   5   6   7   8       &lt;- Edge1
    |   |   |   |   |   |   |   |   |
     -1-     -3-       -2-     -2-          &lt;- The index steps are NOT regular. 
     -1-     -1-       -1-     -1-          &lt;- The index steps are regular. 
    |   |           |       |       |
    0   1           2       3       4       &lt;- Edge2
</code></pre>
<p>The grids can be uniform or not uniform, as long as the index steps between the conforming indices are regular.</p>
<p>If the grids are uniform, we know that the index steps between the conforming indices are regular.
Moreover the index steps are given by the number of cells divided by the greatest common divisor of the
two numbers of cells.
(E.g. if the first example was on uniform grids: <span class="arithmatex">\(\gcd(8,4) = 4\)</span>. On the first edge, the index step is <span class="arithmatex">\(\frac{8}{4} = 2\)</span> and
on the second edge, <span class="arithmatex">\(\frac{4}{4} = 1\)</span>.)</p>
<h2 id="patch-locator">Patch locator</h2>
<p>The patch locator operators identify the patch where a given physical coordinate is.</p>
<h3 id="mappings">Mappings</h3>
<p>On each patch, we define a mapping from the logical domain to the physical domain.</p>
<div class="arithmatex">\[
    \mathcal{F}^{(i)}: \hat{\Omega}^{(i)} \rightarrow \Omega^{(i)}
\]</div>
<p>(The <span class="arithmatex">\(\hat{\Omega}^{(i)}\)</span> refers to the above domain <span class="arithmatex">\([a_x^{(i)}, b_x^{(i)}]\times[a_y^{(i)}, b_y^{(i)}]\)</span>.)
The domain <span class="arithmatex">\(\hat{\Omega}^{(i)}\)</span>  is called the <em>logical domain</em> and <span class="arithmatex">\(\Omega^{(i)}\)</span> the <em>physical domain</em>.</p>
<h3 id="global-analytical-invertible-mapping">Global analytical invertible mapping</h3>
<p>We assume that there is a global mapping analytically invertible such that</p>
<div class="arithmatex">\[
    \mathcal{F}: \hat{\Omega} \rightarrow \Omega \\
    (\mathcal{F})^{-1}: \Omega \rightarrow \hat{\Omega} \\
        \text{with } \Omega = \bigcup_{i = 0}^{K} \Omega^{(i)} \quad 
        \text{and } \hat{\Omega} = \bigcup_{i = 0}^{K} \hat{\Omega}^{(i)} .\\
\]</div>
<p>We can easily apply <span class="arithmatex">\((\mathcal{F})^{-1}\)</span> to identify the equivalent logical coordinate of a given physical coordinate <span class="arithmatex">\(x\in\Omega\)</span>.
We check then for each patch if the logical coordinate is on a rectangular logical patch <span class="arithmatex">\(\hat{\Omega}^{(i)}\)</span>,
i.e. if <span class="arithmatex">\((\mathcal{F})^{-1}(x)\in\hat{\Omega}^{(i)}\)</span>.</p>
<h4 id="onion-shaped-geometry">Onion shaped geometry</h4>
<p>We call "onion" shaped geometry a disk-like patch surrounded by concentric ring-like patches.
The patches are defined on the same dimensions <code>R</code> and <code>Theta</code>.
The logical grid is then split into different logical grids, one for each patch.
We can then define one global mapping from the (<code>R</code>, <code>Theta</code>) domain to the (<code>X</code>, <code>Y</code>) domain for all the patches.
This mapping also needs to be defined from the physical domain to the logical domain.</p>
<p>We order the patches from the O-point to the outside boundary.</p>
<p>The patch grids have to be continuous (i.e. we define patches such as <span class="arithmatex">\(b_x^{(i)} = a_x^{(i+1)}\)</span> for
edges on <span class="arithmatex">\(\{a_x^{(i)}\}\times[a_y^{(i)}, b_y^{(i)}]\)</span> and <span class="arithmatex">\(\{b_x^{(i+1)}\}\times[a_y^{(i+1)}, b_y^{(i+1)}]\)</span>).</p>
<p>In the <code>OnionPatchLocator</code> operator, we use these properties to apply a dichotomy method
and reduce the number of tests to identify where the physical coordinate is.</p>
<h2 id="references">References</h2>
<p>[1] Buchegger, F., JÃ¼ttler, B., Mantzaflaris, A.,
<em>Adaptively refined multi-patch B-splines with enhanced smoothness</em>.
Applied Mathematics and Computation,
Volume 272, Part 1
(2016).
<a href="https://www.sciencedirect.com/science/article/pii/S009630031500836X">https://www.sciencedirect.com/science/article/pii/S009630031500836X</a>.</p>
<h2 id="contents">Contents</h2>
<ul>
<li><code>edge_transformation.hpp</code>: Define the <code>EdgeTransformation</code> operator to transform the coordinate from one edge to the other (see above).</li>
<li><code>edge.hpp</code>: Define the <code>Edge</code> structure.</li>
<li><code>interface.hpp</code>: Define the <code>Interface</code> structure.</li>
<li><code>ipatch_locator.hpp</code>: Define the base class <code>IPatchLocator</code> for the operators identifying the patch where a physical coordinate is.</li>
<li><code>onion_patch_locator.hpp</code>: Define a child class <code>OnionPatchLocator</code> specialised for "onion" type geometries.</li>
<li><code>matching_idx_slice.hpp</code> : Define <code>MatchingIdxSlice</code> storing the conforming indices of both patch at a given interface.</li>
<li><code>patch.hpp</code>: Define the <code>Patch</code> tag.</li>
</ul></div>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../index.html" class="btn btn-neutral float-left" title="Multipatch"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../data_types/index.html" class="btn btn-neutral float-right" title="Data Types for Multipatch Geometry">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
        <span>
          <a href="https://github.com/gyselax/gyselalibxx/" class="fa fa-github" style="color: #fcfcfc"> GitHub</a>
        </span>
    
    
      <span><a href="../index.html" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../data_types/index.html" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../../../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "../../..";</script>
    <script src="../../../js/theme_extra.js"></script>
    <script src="../../../js/theme.js"></script>
      <script src="../../../docs/jscript/mathjax.js"></script>
      <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      <script src="../../../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
