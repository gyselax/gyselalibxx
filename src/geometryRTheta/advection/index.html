<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../../../img/favicon.ico" />
    <title>Advection operator - GyselalibX</title>
    <link rel="stylesheet" href="../../../css/theme.css" />
    <link rel="stylesheet" href="../../../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Advection operator";
        var mkdocs_page_input_path = "src/geometryRTheta/advection/README.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../../../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../../.." class="icon icon-home"> GyselalibX
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption"><span class="caption-text">General</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../../index.html">Home</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >First Steps</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../../docs/first_steps/getting_started.html">Getting Started</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" >Installation</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../../../docs/first_steps/install.html">Gyselalib++ Installation</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../../toolchains/index.html">Pre-made build settings</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../docs/first_steps/DDC_in_gyselalibxx.html">DDC in Gyselalib++</a>
                </li>
    </ul>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Standards</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../../docs/standards/CODING_STANDARD.html">Coding Standard</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../docs/standards/mathematical_and_physical_conventions.html">Math & Physics</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Gyselalib++</span></p>
              <ul class="current">
                  <li class="toctree-l1 current"><a class="reference internal current" >Source</a>
    <ul class="current">
                <li class="toctree-l2"><a class="reference internal" href="../../index.html">Gyselalib++ contents</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" >advection</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../../advection/index.html">Advection methods</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" >collisions</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../../collisions/index.html">Collisions</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" >data_types</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../../data_types/index.html">Data Storage Types</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l2 current"><a class="reference internal current" >geometryRTheta</a>
    <ul class="current">
                <li class="toctree-l3"><a class="reference internal" href="../index.html">Geometry (r, theta)</a>
                </li>
                <li class="toctree-l3 current"><a class="reference internal current" >advection</a>
    <ul class="current">
                <li class="toctree-l4 current"><a class="reference internal current" href="#">Advection operator</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l3"><a class="reference internal" >advection_field</a>
    <ul>
                <li class="toctree-l4"><a class="reference internal" href="../advection_field/index.html">Advection Field finder</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l3"><a class="reference internal" >geometry</a>
    <ul>
                <li class="toctree-l4"><a class="reference internal" href="../geometry/index.html">Geometry RTheta</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l3"><a class="reference internal" >initialisation</a>
    <ul>
                <li class="toctree-l4"><a class="reference internal" href="../initialisation/index.html">Initialisation</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l3"><a class="reference internal" >poisson</a>
    <ul>
                <li class="toctree-l4"><a class="reference internal" href="../poisson/index.html">Polar Poisson solver</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l3"><a class="reference internal" >time_solver</a>
    <ul>
                <li class="toctree-l4"><a class="reference internal" href="../time_solver/index.html">Predictor-corrector methods</a>
                </li>
    </ul>
                </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" >geometryVparMu</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../../geometryVparMu/index.html">Geometry (vpar, mu)</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" >collisions</a>
    <ul>
                <li class="toctree-l4"><a class="reference internal" href="../../geometryVparMu/collisions/index.html">CollisionConfiguration</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l3"><a class="reference internal" >geometry</a>
    <ul>
                <li class="toctree-l4"><a class="reference internal" href="../../geometryVparMu/geometry/index.html">GeometryVparMu</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l3"><a class="reference internal" >initialisation</a>
    <ul>
                <li class="toctree-l4"><a class="reference internal" href="../../geometryVparMu/initialisation/index.html">Initialisation methods</a>
                </li>
    </ul>
                </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" >geometryXVx</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../../geometryXVx/index.html">Geometry (x, v_x)</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" >boltzmann</a>
    <ul>
                <li class="toctree-l4"><a class="reference internal" href="../../geometryXVx/boltzmann/index.html">Boltzmann solver</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l3"><a class="reference internal" >geometry</a>
    <ul>
                <li class="toctree-l4"><a class="reference internal" href="../../geometryXVx/geometry/index.html">Geometry X-Vx</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l3"><a class="reference internal" >initialisation</a>
    <ul>
                <li class="toctree-l4"><a class="reference internal" href="../../geometryXVx/initialisation/index.html">Initialisation methods</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l3"><a class="reference internal" >poisson</a>
    <ul>
                <li class="toctree-l4"><a class="reference internal" href="../../geometryXVx/poisson/index.html">Quasi-Neutrality Solver</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l3"><a class="reference internal" >rhs</a>
    <ul>
                <li class="toctree-l4"><a class="reference internal" href="../../geometryXVx/rhs/index.html">RHS</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l3"><a class="reference internal" >time_integration</a>
    <ul>
                <li class="toctree-l4"><a class="reference internal" href="../../geometryXVx/time_integration/index.html">Time integration</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l3"><a class="reference internal" >utils</a>
    <ul>
                <li class="toctree-l4"><a class="reference internal" href="../../geometryXVx/utils/index.html">Utils</a>
                </li>
    </ul>
                </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" >geometryXY</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../../geometryXY/index.html">Geometry (x, y)</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" >geometry</a>
    <ul>
                <li class="toctree-l4"><a class="reference internal" href="../../geometryXY/geometry/index.html">Geometry XY</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l3"><a class="reference internal" >initialisation</a>
    <ul>
                <li class="toctree-l4"><a class="reference internal" href="../../geometryXY/initialisation/index.html">Initialisation on (x,y) geometry</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l3"><a class="reference internal" >time_integration</a>
    <ul>
                <li class="toctree-l4"><a class="reference internal" href="../../geometryXY/time_integration/index.html">Predictor-corrector methods</a>
                </li>
    </ul>
                </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" >geometryXYVxVy</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../../geometryXYVxVy/index.html">Geometry (x, y, v_x, v_y)</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" >geometry</a>
    <ul>
                <li class="toctree-l4"><a class="reference internal" href="../../geometryXYVxVy/geometry/index.html">Geometry X Y-Vx Vy</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l3"><a class="reference internal" >initialisation</a>
    <ul>
                <li class="toctree-l4"><a class="reference internal" href="../../geometryXYVxVy/initialisation/index.html">Initialisation methods</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l3"><a class="reference internal" >poisson</a>
    <ul>
                <li class="toctree-l4"><a class="reference internal" href="../../geometryXYVxVy/poisson/index.html">Quasi-Neutrality Solver</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l3"><a class="reference internal" >time_integration</a>
    <ul>
                <li class="toctree-l4"><a class="reference internal" href="../../geometryXYVxVy/time_integration/index.html">Time integration</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l3"><a class="reference internal" >vlasov</a>
    <ul>
                <li class="toctree-l4"><a class="reference internal" href="../../geometryXYVxVy/vlasov/index.html">Vlasov solver</a>
                </li>
    </ul>
                </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" >interpolation</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../../interpolation/index.html">Interpolation Methods</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" >polar_splines</a>
    <ul>
                <li class="toctree-l4"><a class="reference internal" href="../../interpolation/polar_splines/index.html">Polar Splines</a>
                </li>
    </ul>
                </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" >io</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../../io/index.html">Functions used for input and output</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" >mapping</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../../mapping/index.html">Mappings</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" >math_tools</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../../math_tools/index.html">Utility Functions</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" >matrix_tools</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../../matrix_tools/index.html">Matrix tools</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" >mpi_parallelisation</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../../mpi_parallelisation/index.html">Parallelisation</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" >multipatch</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../../multipatch/index.html">Multipatch</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" >connectivity</a>
    <ul>
                <li class="toctree-l4"><a class="reference internal" href="../../multipatch/connectivity/index.html">Multipatch connectivity</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l3"><a class="reference internal" >data_types</a>
    <ul>
                <li class="toctree-l4"><a class="reference internal" href="../../multipatch/data_types/index.html">Data Types for Multipatch Geometry</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l3"><a class="reference internal" >spline</a>
    <ul>
                <li class="toctree-l4"><a class="reference internal" href="../../multipatch/spline/index.html">Spline on multipatch geometry</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l3"><a class="reference internal" >utils</a>
    <ul>
                <li class="toctree-l4"><a class="reference internal" href="../../multipatch/utils/index.html">Multipatch utilitary functions</a>
                </li>
    </ul>
                </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" >pde_solvers</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../../pde_solvers/index.html">PDE Solvers</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" >quadrature</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../../quadrature/index.html">Quadrature Methods</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" >speciesinfo</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../../speciesinfo/index.html">SpeciesInfo (x, v_x)</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" >timestepper</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../../timestepper/index.html">Time Stepping Methods</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" >utils</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../../utils/index.html">Utility Functions</a>
                </li>
    </ul>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Simulations</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../../simulations/index.html">Gyselalib++ simulations</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" >geometryRTheta</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../../../simulations/geometryRTheta/index.html">Simulations in (r, theta) geometry</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" >diocotron</a>
    <ul>
                <li class="toctree-l4"><a class="reference internal" href="../../../simulations/geometryRTheta/diocotron/index.html">Diocotron instability</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l3"><a class="reference internal" >vortex_merger</a>
    <ul>
                <li class="toctree-l4"><a class="reference internal" href="../../../simulations/geometryRTheta/vortex_merger/index.html">Vortex merger</a>
                </li>
    </ul>
                </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" >geometryXVx</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../../../simulations/geometryXVx/index.html">Simulations in (x, vx) geometry</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" >geometryXY</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../../../simulations/geometryXY/index.html">Simulations in (x, y) geometry</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" >guiding_centre</a>
    <ul>
                <li class="toctree-l4"><a class="reference internal" href="../../../simulations/geometryXY/guiding_centre/index.html">Guiding centre (X,Y) simulation</a>
                </li>
    </ul>
                </li>
    </ul>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Tests</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../../tests/index.html">Gyselalib++ tests</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" >advection</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../../../tests/advection/index.html">Tests on the templated advection operators</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" >geometryRTheta</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../../../tests/geometryRTheta/index.html">Tests : Geometry (r, theta)</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" >advection_rtheta</a>
    <ul>
                <li class="toctree-l4"><a class="reference internal" href="../../../tests/geometryRTheta/advection_rtheta/index.html">Tests on the 2D polar advection operator</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l3"><a class="reference internal" >polar_poisson</a>
    <ul>
                <li class="toctree-l4"><a class="reference internal" href="../../../tests/geometryRTheta/polar_poisson/index.html">Tests on the 2D polar poisson solver</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l3"><a class="reference internal" >spline_interpolator_rtheta</a>
    <ul>
                <li class="toctree-l4"><a class="reference internal" href="../../../tests/geometryRTheta/spline_interpolator_rtheta/index.html">Tests on spline interpolator in polar coordinates</a>
                </li>
    </ul>
                </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" >multipatch</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../../../tests/multipatch/index.html">Multipatch geometry tests</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" >geometries</a>
    <ul>
                <li class="toctree-l4"><a class="reference internal" href="../../../tests/multipatch/geometries/index.html">Multipatch geometries</a>
                </li>
    </ul>
                </li>
    </ul>
                </li>
    </ul>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Development</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../../docs/development/Adding_docs.html">Adding Docs</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../docs/development/Using_git.html">Using Git</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../docs/development/developer_FAQ.html">Developer FAQ</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Troubleshooting</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../../docs/troubleshooting/Common_compilation_problems.html">Compilation Issues</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">API</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" >Gyselalib++</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" >Classes</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../../../gyselalibxx/annotated.html">Class List</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../../gyselalibxx/classes.html">Class Index</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../../gyselalibxx/hierarchy.html">Class Hierarchy</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" >Namespaces</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../../../gyselalibxx/namespaces.html">Namespace List</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../../gyselalibxx/namespace_members.html">Namespace Members</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../../gyselalibxx/namespace_member_functions.html">Namespace Member Functions</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../../gyselalibxx/namespace_member_variables.html">Namespace Member Variables</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../../gyselalibxx/namespace_member_typedefs.html">Namespace Member Typedefs</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../../gyselalibxx/namespace_member_enums.html">Namespace Member Enumerations</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../gyselalibxx/functions.html">Functions</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../gyselalibxx/variables.html">Variables</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../gyselalibxx/macros.html">Macros</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../gyselalibxx/files.html">Files</a>
                </li>
    </ul>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../..">GyselalibX</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../.." class="icon icon-home" aria-label="Docs"></a></li>
          <li class="breadcrumb-item">Gyselalib++</li>
          <li class="breadcrumb-item">Source</li>
          <li class="breadcrumb-item">geometryRTheta</li>
          <li class="breadcrumb-item">advection</li>
      <li class="breadcrumb-item active">Advection operator</li>
    <li class="wy-breadcrumbs-aside">
          <a href="https://github.com/gyselax/gyselalibxx/edit/master/docs/src/geometryRTheta/advection/README.md" class="icon icon-github"> Edit on GitHub</a>
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <div><h1 id="advection-operator">Advection operator</h1>
<h2 id="studied-equation">Studied equation</h2>
<p>The studied equation is the following 2D transport equation type :</p>
<div class="arithmatex">\[
\partial_t f(t,x,y) + A(t,x,y)\cdot\nabla f(t,x,y) = 0,
\]</div>
<p>with <span class="arithmatex">\(f(0,x,y) = f_0(x,y)\)</span> and <em>A</em> the advection field.</p>
<p><strong>We want to solve it on a polar grid so we have:</strong>  <span class="arithmatex">\((t,x,y) = (t,x(r,\theta),y(r,\theta))\)</span>.</p>
<h2 id="backward-semi-lagrangian-method">Backward Semi-Lagrangian method</h2>
<p>The method used to solve the equation is a backward Semi-Lagrangian method (BSL).
It uses the conservation property along the characteristics:</p>
<div class="arithmatex">\[
\forall t, \quad f(t, x, y) = f(s, X(t; s, x, y), Y(t; s, x, y))
\]</div>
<p>with:</p>
<div class="arithmatex">\[
\begin{aligned}
\partial_t X (t; s, x, y) = A(t,X(t; s, x, y),Y(t; s, x, y)) \cdot e_x,\\
\partial_t Y (t; s, x, y) = A(t,X(t; s, x, y),Y(t; s, x, y)) \cdot e_y,\\
X(s; s, x, y) = x,\\
Y(s; s, x, y) = y.
\end{aligned}
\]</div>
<p>So to compute the advected function at the next time step,</p>
<ul>
<li>we compute the feet of the characteristics <span class="arithmatex">\(X(t^n; t^{n+1}, x_i, y_j)\)</span> and <span class="arithmatex">\(Y(t^n; t^{n+1}, x_i, y_j)\)</span>
 for each mesh point <span class="arithmatex">\((x_i, y_j)\)</span> with a time integration method ;</li>
<li>we interpolate the function <span class="arithmatex">\(f(t = t^n)\)</span> on the feet of the characteristics.
 The property ensures that the interpolation gives the function at the next time step <span class="arithmatex">\(f(t = t^{n+1})\)</span>.</li>
</ul>
<h2 id="time-integration-methods">Time integration methods</h2>
<p>There are multiple time integration methods available which are implemented in the ITimeStepper child classes. For example:</p>
<ul>
<li>Explicit Euler method: Euler;</li>
<li>Crank-Nicolson method: CrankNicolson;</li>
<li>Runge-Kutta 3 method: RK3;</li>
<li>Runge-Kutta 4 method: RK4;</li>
</ul>
<p>We are listing the different schemes for this equation <span class="arithmatex">\(\partial_t X (t) = A(t, X(t))\)</span>.</p>
<p>We write <span class="arithmatex">\(X (t) = X (t; s, x)\)</span>, <span class="arithmatex">\(X^n = X(t^n)\)</span> and <span class="arithmatex">\(A^n(X) = A(t^n, X)\)</span> for a time discretisation
<span class="arithmatex">\(\{t^n; t^n &gt; t^{n-1},  \forall n\}_n\)</span>.</p>
<h3 id="explicit-euler-method">Explicit Euler method</h3>
<ul>
<li>
<p>Scheme:
<span class="arithmatex">\(X^n = X^{n+1} - dt A^{n+1}(X^{n+1})\)</span></p>
</li>
<li>
<p>Convergence order : 1.</p>
</li>
</ul>
<h3 id="crank-nicolson-method">Crank-Nicolson method</h3>
<ul>
<li>
<p>Scheme:
<span class="arithmatex">\(X^{k+1} = X^{n+1} - \frac{dt}{2} \left( A^{n+1}(X^{n+1}) + A^k(X^k) \right)\)</span> and
<span class="arithmatex">\(X^{n+1} = X^{k+1}\)</span> once converged.</p>
</li>
<li>
<p>Convergence order : 2.</p>
</li>
</ul>
<h3 id="rk3-method">RK3 method</h3>
<ul>
<li>Scheme:
<span class="arithmatex">\(X^n = X^{n+1} - \frac{dt}{6}  \left( k_1 + 4 k_2 + k_3 \right)\)</span></li>
<li>
<p>with</p>
<ul>
<li><span class="arithmatex">\(k_1 =  A^{n+1}(X^{n+1})\)</span>,</li>
<li><span class="arithmatex">\(k_2 =  A{n+1/2} (X^{n+1} - \frac{dt}{2} k_1)\)</span>,</li>
<li><span class="arithmatex">\(k_3 =  A{n+1/2} (X^{n+1} - dt( 2k_2 - k_1))\)</span>.</li>
</ul>
</li>
<li>
<p>Convergence order : 3.</p>
</li>
</ul>
<h3 id="rk4-method">RK4 method</h3>
<ul>
<li>Scheme:
<span class="arithmatex">\(X^n = X^{n+1} - \frac{dt}{6}  \left( k_1 + 2 k_2 + 2 k_3  + k_4\right)\)</span></li>
<li>
<p>with</p>
<ul>
<li><span class="arithmatex">\(k_1 =  A^{n+1}(X^{n+1})\)</span>,</li>
<li><span class="arithmatex">\(k_2 =  A^{n+1/2} (X^{n+1} - \frac{dt}{2} k_1)\)</span>,</li>
<li><span class="arithmatex">\(k_3 =  A^{n+1/2} (X^{n+1} - \frac{dt}{2} k_2)\)</span>,</li>
<li><span class="arithmatex">\(k_4 =  A^{n} (X^{n+1} - dt k_3)\)</span>.</li>
</ul>
</li>
<li>
<p>Convergence order : 4.</p>
</li>
</ul>
<h2 id="advection-domain">Advection domain</h2>
<p>There are two advection domains to consider:</p>
<ul>
<li>the physical domain;</li>
<li>the pseudo-Cartesian domain.</li>
</ul>
<p>It seems logical to use the <strong>physical domain</strong>, where the studied equation is given, as the advection domain.</p>
<p>However, we want to solve this equation on a polar grid. So before advecting, we have to
compute the mesh points in the physical domain using a mapping function <span class="arithmatex">\(\mathcal{F}\)</span>:</p>
<div class="arithmatex">\[
\mathcal{F} : (r,\theta)_{i,j} \mapsto  (x,y)_{i,j}.
\]</div>
<p>This adds some steps to the advection operator, we now have to compute</p>
<ul>
<li>the mesh points in the physical domain using <span class="arithmatex">\(\mathcal{F}\)</span>;</li>
<li>the feet of the characteristics in the physical domain;</li>
<li>the feet of the characteristics in the logical domain (polar grid) using <span class="arithmatex">\(\mathcal{F}^{-1}\)</span>;</li>
<li>then interpolate the advection function at the feet of the characteristics in the logical domain.</li>
</ul>
<p>The third step can be difficult especially if the mapping function <span class="arithmatex">\(\mathcal{F}\)</span> is not analytically invertible.
It is not impossible, but the computations can be costly.</p>
<p>That is why, we introduce the <strong>pseudo-Cartesian domain</strong>.
We use another mapping function <span class="arithmatex">\(\mathcal{G}\)</span> such that:</p>
<div class="arithmatex">\[
 \mathcal{G} : (r,\theta)_{i,j} \mapsto  (x,y)_{i,j} = (r\cos(\theta), r\sin(\theta))_{i,j}.
\]</div>
<p>Then the four previous steps become</p>
<ul>
<li>calculate the mesh points in the pseudo-Cartesian domain using <span class="arithmatex">\(\mathcal{G}\)</span>;</li>
<li>calculate the advection field <span class="arithmatex">\(A\)</span> in the pseudo-Cartesian domain using the Jacobian matrix of <span class="arithmatex">\((\mathcal{F}\circ\mathcal{G}^{-1})^{-1}\)</span>;</li>
<li>calculate the feet of the characteristics in the pseudo_Cartesian domain;</li>
<li>calculate the feet of the characteristics in the logical domain (polar grid) using <span class="arithmatex">\(\mathcal{G}^{-1}\)</span>;</li>
<li>interpolate the advection function at the feet of the characteristics in the logical domain.</li>
</ul>
<p>Here, <span class="arithmatex">\(\mathcal{G}\)</span> is analytically invertible (we can fix  <span class="arithmatex">\(\mathcal{G}^{-1}(x = 0, y = 0) = (r = 0, \theta = 0)\)</span>)
and  <span class="arithmatex">\((J_{\mathcal{F}}J_{\mathcal{G}}^{-1})^{-1}\)</span> is well-defined. The details are given in Zoni et al. (2019) <sup id="fnref:1"><a class="footnote-ref" href="#fn:1">1</a></sup>.</p>
<p><strong>Remark 1:</strong> if <span class="arithmatex">\(\mathcal{F}\)</span> is the circular mapping function, then the physical domain and the pseudo-Cartesian domain are the same.</p>
<p><strong>Remark 2:</strong> if the mapping function is analytically invertible, it is less costly to advect in the physical domain.</p>
<h2 id="advection-field">Advection Field</h2>
<p>In the studied equation, the advection field is given along the physical domain axis:</p>
<div class="arithmatex">\[
\partial_t f + A \cdot \nabla f = 0.
\]</div>
<p>The BslAdvectionRTheta operator can take as input
the advection field expressed on the <span class="arithmatex">\((e_x, e_y)\)</span> basis of the physical domain or
the advection field expressed on the <span class="arithmatex">\((e_r, e_\theta)\)</span> <a href="../../../docs/standards/mathematical_and_physical_conventions.html">contravariant basis</a> of the logical domain,</p>
<div class="arithmatex">\[
A = A_x e_x + A_y e_y \quad \text{or} \quad A = A^r e_r + A^\theta e_\theta.
\]</div>
<p>The advection field can be computed thanks to the AdvectionFieldFinder operator. This operator returns both expressions of the advection field (see <a href="../advection_field/index.html">advection_field_rtheta</a>).</p>
<ul>
<li>
<p>If the advection field is directly expressed on the <span class="arithmatex">\((e_x, e_y)\)</span> basis of the physical domain, no treatment is needed in the BslAdvectionRTheta operator.</p>
</li>
<li>
<p>If the advection field is expressed on the <span class="arithmatex">\((e_r, e_\theta)\)</span> contravariant basis of the logical domain, then we need to compute the advection field on the <span class="arithmatex">\((e_x, e_y)\)</span> basis to advect in the physical domain.</p>
</li>
</ul>
<p>To pass from the composants on the <span class="arithmatex">\((e_r, e_\theta)\)</span> contravariant basis to the composants on the <span class="arithmatex">\((e_x, e_y)\)</span> basis, we use the Jacobian matrix <em>J</em> of the coordinate transformation <span class="arithmatex">\((r,\theta) \mapsto (x,y)\)</span>,</p>
<div class="arithmatex">\[
\begin{bmatrix}
    A\cdot e_x \\
    A\cdot e_y
\end{bmatrix}
=
J
\begin{bmatrix}
    A \cdot e_{r} \\
    A \cdot e_{\theta}
\end{bmatrix}.
\]</div>
<h2 id="unit-tests">Unit tests</h2>
<p>The test of the advection operator are implemented in the <code>tests/geometryRTheta/advection_rtheta/</code> folder
(<a href="../../../tests/geometryRTheta/advection_rtheta/index.html">advection_2d_rp</a>).</p>
<p>It tests:</p>
<ul>
<li>the 4 time integration methods;</li>
<li>the different mappings and advection domains:</li>
<li>Circular mapping in the physical domain;</li>
<li>Czarny mapping in the physical domain;</li>
<li>Czarny mapping in the pseudo-Cartesian domain;</li>
<li>Discrete mapping of the Czarny mapping in the pseudo-Cartesian domain.</li>
<li>on 3 different simulations:</li>
<li>simulation 1: translation of Gaussian function<ul>
<li><span class="arithmatex">\(f_0(x,y) = \exp\left( - \frac{(x- x_0)^2}{2 \sigma_x^2} - \frac{(y- y_0)^2}{2 \sigma_y^2} \right)\)</span>,</li>
<li><span class="arithmatex">\(A(t, x, y) = (v_x, v_y)\)</span> .</li>
</ul>
</li>
<li>simulation 2: rotation of Gaussian function<ul>
<li><span class="arithmatex">\(f_0(x,y) = \exp\left( - \frac{(x- x_0)^2}{2 \sigma_x^2} - \frac{(y- y_0)^2}{2 \sigma_y^2} \right)\)</span>,</li>
<li><span class="arithmatex">\(A(t, x, y) = J_{\mathcal{F}_{\text{circular}}}(v_r, v_\theta)\)</span>.</li>
</ul>
</li>
<li>simulation 3: decentred rotation (test given in Zoni et al. (2019) <sup id="fnref2:1"><a class="footnote-ref" href="#fn:1">1</a></sup>).<ul>
<li><span class="arithmatex">\(f_0(x,y) = \frac{1}{2} \left( G(r_1(x,y)) + G(r_2(x,y))\right)\)</span>,</li>
<li>with<ul>
<li><span class="arithmatex">\(G(r) = \cos\left(\frac{\pi r}{2 a}\right)^4 * 1_{r&lt;a}(r)\)</span>,</li>
<li><span class="arithmatex">\(r_1(x, y) = \sqrt{(x-x_0)^2 + 8(y-y_0)^2}\)</span></li>
<li><span class="arithmatex">\(r_2(x, y) = \sqrt{8(x-x_0)^2 + (y-y_0)^2}\)</span></li>
</ul>
</li>
<li><span class="arithmatex">\(A(t, x, y) = \omega(y_c - y, x - x_c)\)</span>.</li>
</ul>
</li>
</ul>
<p>The tests of the convergence order are made for constant CFL which means it checks the slope of the errors
(infinity norm of the difference at the final time)
for <span class="arithmatex">\((N_r\times N_\theta, dt) = (N_{r,0}\times N_{\theta,0}, dt_0)\)</span> and then <span class="arithmatex">\((n*N_{r,0}\times n*N_{\theta,0}, dt_0/n)\)</span>
for <span class="arithmatex">\(n = 1, 2, 4, 8,  ...\)</span>.</p>
<h2 id="contents">Contents</h2>
<p>This folder contains:</p>
<ul>
<li>iadvection_rtheta.hpp : define the base class for advection operator (IAdvectionRTheta).</li>
<li>bsl_advection_rtheta.hpp : define the advection operator described just before (BslAdvectionRTheta).</li>
</ul>
<h2 id="references">References</h2>
<div class="footnote">
<hr>
<ol>
<li id="fn:1">
<p>Edoardo Zoni, Yaman Güçlü. "Solving hyperbolic-elliptic problems on singular mapped
disk-like domains with the method of characteristics and spline finite elements".
(<a href="https://doi.org/10.1016/j.jcp.2019.108889">https://doi.org/10.1016/j.jcp.2019.108889</a>.)
Journal of Computational Physics (2019). <a class="footnote-backref" href="#fnref:1" title="Jump back to footnote 1 in the text">↩</a><a class="footnote-backref" href="#fnref2:1" title="Jump back to footnote 1 in the text">↩</a></p>
</li>
</ol>
</div></div>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../index.html" class="btn btn-neutral float-left" title="Geometry (r, theta)"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../advection_field/index.html" class="btn btn-neutral float-right" title="Advection Field finder">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
        <span>
          <a href="https://github.com/gyselax/gyselalibxx/" class="fa fa-github" style="color: #fcfcfc"> GitHub</a>
        </span>
    
    
      <span><a href="../index.html" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../advection_field/index.html" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../../../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "../../..";</script>
    <script src="../../../js/theme_extra.js"></script>
    <script src="../../../js/theme.js"></script>
      <script src="../../../docs/jscript/mathjax.js"></script>
      <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      <script src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>
      <script src="../../../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
