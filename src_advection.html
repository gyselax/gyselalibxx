<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Gyselalib++: Advection methods</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="logo.png"/></td>
  <td id="projectalign">
   <div id="projectname">Gyselalib++
   </div>
  </td>
    <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <span id="MSearchSelect"                onmouseover="return searchBox.OnSearchSelectShow()"                onmouseout="return searchBox.OnSearchSelectHide()">&#160;</span>
          <input type="text" id="MSearchField" value="" placeholder="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('src_advection.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Advection methods</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>The <code>advection/</code> folder gathers the backward semi lagrangian scheme classes. There are two main classes, AdvectionSpatial and AdvectionVelocity. Implementing these operators separately makes sense, since we are using time splitting.</p>
<p>The feet of the characteristic curves are used to interpolate the updated distribution function on mesh points. It uses batched interpolators so the interpolation step is done over the whole distribution function.</p>
<h1><a class="anchor" id="src_advection__Spatial_advection"></a>
Spatial advection</h1>
<p>Here the purpose is the advection along a direction on the physical space dimension of the phase space. The dynamics of the motion on the spatial dimension are governed by the following equation.</p>
<p class="formulaDsp">
\[ \frac{df_s}{dt}= \sqrt{\frac{m_e}{m_s}} v \frac{\partial f_s}{\partial x} \]
</p>
<h1><a class="anchor" id="src_advection__Velocity_advection"></a>
Velocity advection</h1>
<p>Here the purpose is the advection along a direction on the velocity space dimension of the phase space. The dynamics of the motion on the velocity dimension are governed by the following equation, where E is the electric field.</p>
<p class="formulaDsp">
\[ \frac{df_s}{dt}= q_s \sqrt{\frac{m_e}{m_s}} E \frac{\partial f_s}{\partial v} \]
</p>
<h1><a class="anchor" id="src_advection__1D_advection_with_a_given_advection_field"></a>
1D advection with a given advection field</h1>
<p>The purpose of the <a class="el" href="classBslAdvection1D.html" title="A class which computes the advection along the dimension of interest GridInterest.">BslAdvection1D</a> operator is an advection along a given direction of the phase space. The advection field is given as input. The dynamics of the motion are governed by the following equation.  </p><p class="formulaDsp">
\[    \partial_t f(t,x) + A\partial_{x_i}(x&#39;)f(t,x) = 0, 
    \qquad x \in \Omega, x&#39; \in \Omega&#39;,
\]
</p>
<p> with</p><ul>
<li>\(f\) the function to advect. It is defined on \(\Omega\) domain and the time dimension;</li>
<li>\(A\) the advection field. It could be defined on a subdomain \(\Omega&#39;\subset \Omega\);</li>
<li>and \(x_i\) a given direction. The advection field domain has to be defined on this dimension for the time integration method. <br  />
</li>
</ul>
<h3><a class="anchor" id="autotoc_md39"></a>
Example of use</h3>
<p>Here are some examples of equation types the <a class="el" href="classBslAdvection1D.html" title="A class which computes the advection along the dimension of interest GridInterest.">BslAdvection1D</a> operator can solve:</p><ul>
<li>Equation on a 1D domain (and time dimension):  <p class="formulaDsp">
\[    \partial_t f(t,x) + A_x(x)\partial_{x}f(t,x) = 0,
    \qquad x \in \Omega,
\]
</p>
 Here \(\Omega&#39; = \Omega \in \mathbb{R}\). In the code, it would correspond to <div class="fragment"><div class="line">DFieldX f(idx_range_x); </div>
<div class="line">DFieldX A(idx_range_x); </div>
<div class="line"><span class="keyword">using </span>IDimInterest = IDimX; </div>
</div><!-- fragment --></li>
<li>Equation on a 2D domain (and time dimension):  <p class="formulaDsp">
\[    \partial_t f(t,x,y) + A_x(x,y)\partial_{x}f(t,x,y) = 0,
\]
</p>
 Here \(\Omega&#39; = \Omega \in \mathbb{R}^2\). In the code, it would correspond to <div class="fragment"><div class="line">DFieldXY f(idx_range_xy); </div>
<div class="line">DFieldXY A(idx_range_xy); </div>
<div class="line"><span class="keyword">using </span>IDimInterest = IDimX; </div>
</div><!-- fragment --></li>
<li>Equation on a 2Dx2V domain (and time dimension):  <p class="formulaDsp">
\[    \partial_t f(t,x,y,v_x,v_y) + A_x(x,y)\partial_{x}f(t,x,y,v_x,v_y) = 0,
\]
</p>
 Here \(\Omega&#39; \in \mathbb{R}^2\) and \(\Omega \in \mathbb{R}^4\). In the code, it would correspond to <div class="fragment"><div class="line">DFieldXYVxVy f(idx_range_xyvxvy); </div>
<div class="line">DFieldXY A(idx_range_xy); </div>
<div class="line"><span class="keyword">using </span>IDimInterest = IDimX; </div>
</div><!-- fragment --></li>
<li>Equation on a 1Dx1V domain (and time dimension):  <p class="formulaDsp">
\[\begin{aligned}
    &amp; \partial_t f(t,x,v_x) + A_x(x,v_x)\partial_{x}f(t,x,v_x) = 0, 
    \qquad \text{ with for instance, } A_x(x,v_x) = v_x, \\
    &amp; \text{or } \partial_t f(t,x,v_x) + A_{v_x}(x,v_x)\partial_{v_x}f(t,x,v_x) = 0, 
    \qquad \text{ with for instance, } A_{v_x}(x,v_x) = E(x), 
\end{aligned}
\]
</p>
 Here \(\Omega&#39; = \Omega \in \mathbb{R}^2\). In the code, it would correspond to <div class="fragment"><div class="line">DFieldXVx f(idx_range_xvx); </div>
<div class="line">DFieldXVx A(idx_range_xvx); </div>
<div class="line"><span class="keyword">using </span>IDimInterest = IDimX; </div>
</div><!-- fragment --> or <div class="fragment"><div class="line"><span class="keyword">using </span>IDimInterest = IDimVx; </div>
</div><!-- fragment --></li>
<li>Equation on a 1Dx1V domain with species dimension (and time dimension):  <p class="formulaDsp">
\[\begin{aligned}
    &amp; \partial_t f_s(t,x,v_x) + A_{s,x}(x)\partial_{x}f_s(t,x,v_x) = 0, 
\end{aligned}
\]
</p>
 Here \(\Omega&#39; = \Omega \in \mathbb{R}^2\). In the code, it would correspond to <div class="fragment"><div class="line">DFieldSpXVx f(idx_range_sp_xvx); </div>
<div class="line">DFieldSpX A(idx_range_sp_x); </div>
<div class="line"><span class="keyword">using </span>IDimInterest = IDimX; </div>
</div><!-- fragment --></li>
</ul>
<h3><a class="anchor" id="autotoc_md40"></a>
Parameters</h3>
<p>The operator takes as templated parameters:</p><ul>
<li>IDimInterest: a dimension of interest (or advection dimension) wich refers to the dimension along wich we advect the function;</li>
<li><a class="el" href="classAdvectionDomain.html" title="Define a domain for the advection.">AdvectionDomain</a>: an advection domain, which refers to the domain where the advection field is defined. It has to contain the dimension of interest for the interpolation of the advection field in the time integration method;</li>
<li>FunctionDomain: the full domain where the function we want to advect is defined;</li>
<li>AdvectionFieldBuilder: a spline builder type for the advection field.</li>
<li>AdvectionFieldEvaluator: a spline evaluator type for the advection field.</li>
<li>TimeStepper: a time integration method (see <a class="el" href="src_timestepper.html">Time Stepping Methods</a>) to solve the characteristic equation. It has to be defined on the advection field domain. The feet have to be a Field of coordinates of the dimension of interest defined on the advection field domain.</li>
</ul>
<p><b>Remark/Warning:</b> the <a class="el" href="classBslAdvection1D.html" title="A class which computes the advection along the dimension of interest GridInterest.">BslAdvection1D</a> operator is built with builder and evaluator for the advection field and interpolator for the function we want to advect. Theses operators have to be defined on the same domain as the advection field and function. For instance, if the advection field and/or the function are defined on the species dimension, then the interpolators have to contain the species dimension in its batched dimensions (see tests in the <code>tests/advection/</code> folder).</p>
<p><b>Remark/Warning:</b> The advection field need to use interpolation on B-splines. So we cannot use other type of interpolator for the advection field. However there is no constraint on the interpolator of the advected function. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
