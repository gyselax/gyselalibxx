<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<doxygen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="compound.xsd" version="1.9.8" xml:lang="en-US">
  <compounddef id="collision__configuration_8hpp" kind="file" language="C++">
    <compoundname>collision_configuration.hpp</compoundname>
    <includes local="no">paraconf.h</includes>
    <includes refid="collision__common__configuration_8hpp" local="yes">collision_common_configuration.hpp</includes>
    <includes refid="paraconfpp_8hpp" local="yes">paraconfpp.hpp</includes>
    <incdepgraph>
      <node id="3">
        <label>collision_common_configuration.hpp</label>
        <link refid="collision__common__configuration_8hpp_source"/>
        <childnode refid="2" relation="include">
        </childnode>
        <childnode refid="4" relation="include">
        </childnode>
        <childnode refid="8" relation="include">
        </childnode>
        <childnode refid="10" relation="include">
        </childnode>
        <childnode refid="14" relation="include">
        </childnode>
      </node>
      <node id="1">
        <label>/home/runner/work/gyselalibxx/gyselalibxx/code_branch/src/geometryVparMu/collisions/collision_configuration.hpp</label>
        <link refid="collision__configuration_8hpp"/>
        <childnode refid="2" relation="include">
        </childnode>
        <childnode refid="3" relation="include">
        </childnode>
        <childnode refid="10" relation="include">
        </childnode>
      </node>
      <node id="10">
        <label>paraconfpp.hpp</label>
        <link refid="paraconfpp_8hpp_source"/>
        <childnode refid="11" relation="include">
        </childnode>
        <childnode refid="12" relation="include">
        </childnode>
        <childnode refid="13" relation="include">
        </childnode>
        <childnode refid="6" relation="include">
        </childnode>
        <childnode refid="2" relation="include">
        </childnode>
      </node>
      <node id="14">
        <label>species_info.hpp</label>
        <link refid="species__info_8hpp_source"/>
        <childnode refid="7" relation="include">
        </childnode>
        <childnode refid="4" relation="include">
        </childnode>
        <childnode refid="8" relation="include">
        </childnode>
        <childnode refid="15" relation="include">
        </childnode>
      </node>
      <node id="4">
        <label>ddc_alias_inline_functions.hpp</label>
        <link refid="ddc__alias__inline__functions_8hpp_source"/>
        <childnode refid="5" relation="include">
        </childnode>
        <childnode refid="6" relation="include">
        </childnode>
        <childnode refid="7" relation="include">
        </childnode>
        <childnode refid="8" relation="include">
        </childnode>
      </node>
      <node id="8">
        <label>ddc_aliases.hpp</label>
        <link refid="ddc__aliases_8hpp_source"/>
        <childnode refid="7" relation="include">
        </childnode>
        <childnode refid="9" relation="include">
        </childnode>
      </node>
      <node id="15">
        <label>ddc_helper.hpp</label>
        <link refid="ddc__helper_8hpp_source"/>
        <childnode refid="16" relation="include">
        </childnode>
        <childnode refid="17" relation="include">
        </childnode>
        <childnode refid="7" relation="include">
        </childnode>
        <childnode refid="8" relation="include">
        </childnode>
      </node>
      <node id="16">
        <label>cassert</label>
      </node>
      <node id="17">
        <label>cmath</label>
      </node>
      <node id="7">
        <label>ddc/ddc.hpp</label>
      </node>
      <node id="9">
        <label>ddc/kernels/splines.hpp</label>
      </node>
      <node id="11">
        <label>filesystem</label>
      </node>
      <node id="2">
        <label>paraconf.h</label>
      </node>
      <node id="12">
        <label>stdexcept</label>
      </node>
      <node id="13">
        <label>string</label>
      </node>
      <node id="5">
        <label>type_traits</label>
      </node>
      <node id="6">
        <label>utility</label>
      </node>
    </incdepgraph>
    <innerclass refid="classCollisionConfiguration" prot="public">CollisionConfiguration</innerclass>
    <briefdescription>
    </briefdescription>
    <detaileddescription>
    </detaileddescription>
    <programlisting>
<codeline lineno="1"><highlight class="comment">//<sp/>SPDX-License-Identifier:<sp/>MIT</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2"><highlight class="normal"></highlight></codeline>
<codeline lineno="3"><highlight class="normal"></highlight><highlight class="preprocessor">#pragma<sp/>once</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4"><highlight class="normal"></highlight></codeline>
<codeline lineno="5"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;paraconf.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="6"><highlight class="normal"></highlight></codeline>
<codeline lineno="7"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;collision_common_configuration.hpp&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="8"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;paraconfpp.hpp&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="9"><highlight class="normal"></highlight></codeline>
<codeline lineno="18"><highlight class="normal"></highlight><highlight class="keyword">template</highlight><highlight class="normal"><sp/>&lt;</highlight><highlight class="keyword">class</highlight><highlight class="normal"><sp/>Gr</highlight><highlight class="keywordtype">id</highlight><highlight class="normal">Sp,<sp/></highlight><highlight class="keyword">class</highlight><highlight class="normal"><sp/>Gr</highlight><highlight class="keywordtype">id</highlight><highlight class="normal">Vpar,<sp/></highlight><highlight class="keyword">class</highlight><highlight class="normal"><sp/>Gr</highlight><highlight class="keywordtype">id</highlight><highlight class="normal">Mu&gt;</highlight></codeline>
<codeline lineno="19" refid="classCollisionConfiguration" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classCollisionConfiguration" kindref="compound">CollisionConfiguration</ref></highlight></codeline>
<codeline lineno="20"><highlight class="normal">{</highlight></codeline>
<codeline lineno="21"><highlight class="normal"></highlight><highlight class="keyword">public</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="25" refid="classCollisionConfiguration_1a77e5d69224da2c41da3bb3ed08f316e2" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">using<sp/></highlight><highlight class="normal"><ref refid="structGridMu" kindref="compound">GridMuType</ref><sp/>=<sp/><ref refid="structGridMu" kindref="compound">GridMu</ref>;</highlight></codeline>
<codeline lineno="29" refid="classCollisionConfiguration_1abad505b2c709e1f9a0b2eca642819576" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">using<sp/></highlight><highlight class="normal"><ref refid="structGridVpar" kindref="compound">GridVparType</ref><sp/>=<sp/><ref refid="structGridVpar" kindref="compound">GridVpar</ref>;</highlight></codeline>
<codeline lineno="33" refid="classCollisionConfiguration_1aec3210b40ef49f0c8d361e6eeeaeac16" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">using<sp/></highlight><highlight class="normal"><ref refid="classCollisionConfiguration_1aec3210b40ef49f0c8d361e6eeeaeac16" kindref="member">GridThetaType</ref><sp/>=<sp/>detail::InternalSpoofGridTheta;</highlight></codeline>
<codeline lineno="37" refid="classCollisionConfiguration_1af70141c99127445cd13f1538bcd5b1b6" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">using<sp/></highlight><highlight class="normal"><ref refid="classCollisionConfiguration_1af70141c99127445cd13f1538bcd5b1b6" kindref="member">GridRType</ref><sp/>=<sp/>detail::InternalSpoofGridR;</highlight></codeline>
<codeline lineno="41" refid="classCollisionConfiguration_1ad23e1c19b3c9ad3ec57abf9faeded4a2" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">using<sp/></highlight><highlight class="normal"><ref refid="classCollisionConfiguration_1ad23e1c19b3c9ad3ec57abf9faeded4a2" kindref="member">GridPhiType</ref><sp/>=<sp/>detail::InternalSpoofGridPhi;</highlight></codeline>
<codeline lineno="45" refid="classCollisionConfiguration_1a8519967631bca4d1974d92445159e363" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">using<sp/></highlight><highlight class="normal"><ref refid="classCollisionConfiguration_1a8519967631bca4d1974d92445159e363" kindref="member">GridSpType</ref><sp/>=<sp/>GridSp;</highlight></codeline>
<codeline lineno="46"><highlight class="normal"></highlight></codeline>
<codeline lineno="50" refid="classCollisionConfiguration_1a4e186e5b73d038f9506f12ca595a0c13" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">using<sp/></highlight><highlight class="normal"><ref refid="classCollisionConfiguration_1a4e186e5b73d038f9506f12ca595a0c13" kindref="member">IdxRangeMuType</ref><sp/>=<sp/>IdxRange&lt;GridMuType&gt;;</highlight></codeline>
<codeline lineno="54" refid="classCollisionConfiguration_1ae670abd3ec52030c53d712175336c244" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">using<sp/></highlight><highlight class="normal"><ref refid="classCollisionConfiguration_1ae670abd3ec52030c53d712175336c244" kindref="member">IdxRangeVparType</ref><sp/>=<sp/>IdxRange&lt;GridVparType&gt;;</highlight></codeline>
<codeline lineno="58" refid="classCollisionConfiguration_1acacaddd6c74b2c52ee14e6b5d4983467" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">using<sp/></highlight><highlight class="normal"><ref refid="classCollisionConfiguration_1acacaddd6c74b2c52ee14e6b5d4983467" kindref="member">IdxRangeSpVparType</ref><sp/>=<sp/>IdxRange&lt;GridSpType,<sp/>GridVparType&gt;;</highlight></codeline>
<codeline lineno="62" refid="classCollisionConfiguration_1af04c3dc20040cbe7a074981e9d153b85" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">using<sp/></highlight><highlight class="normal"><ref refid="classCollisionConfiguration_1af04c3dc20040cbe7a074981e9d153b85" kindref="member">IdxRangeDistributionFunctionType</ref><sp/>=<sp/>IdxRange&lt;GridSpType,<sp/>GridVparType,<sp/>GridMuType&gt;;</highlight></codeline>
<codeline lineno="63"><highlight class="normal"></highlight></codeline>
<codeline lineno="67" refid="classCollisionConfiguration_1af6f098de78a916ed942a90890981acbe" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">using<sp/></highlight><highlight class="normal"><ref refid="classCollisionConfiguration_1af6f098de78a916ed942a90890981acbe" kindref="member">CollisionConfigurationDataType</ref><sp/>=<sp/>detail::CollisionConfigurationData&lt;</highlight></codeline>
<codeline lineno="68"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classCollisionConfiguration_1af04c3dc20040cbe7a074981e9d153b85" kindref="member">IdxRangeDistributionFunctionType</ref>,</highlight></codeline>
<codeline lineno="69"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classCollisionConfiguration_1a8519967631bca4d1974d92445159e363" kindref="member">GridSpType</ref>,</highlight></codeline>
<codeline lineno="70"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classCollisionConfiguration_1ad23e1c19b3c9ad3ec57abf9faeded4a2" kindref="member">GridPhiType</ref>,</highlight></codeline>
<codeline lineno="71"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classCollisionConfiguration_1af70141c99127445cd13f1538bcd5b1b6" kindref="member">GridRType</ref>,</highlight></codeline>
<codeline lineno="72"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classCollisionConfiguration_1aec3210b40ef49f0c8d361e6eeeaeac16" kindref="member">GridThetaType</ref>,</highlight></codeline>
<codeline lineno="73"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classCollisionConfiguration_1abad505b2c709e1f9a0b2eca642819576" kindref="member">GridVparType</ref>,</highlight></codeline>
<codeline lineno="74"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structGridMu" kindref="compound">GridMuType</ref>&gt;;</highlight></codeline>
<codeline lineno="75"><highlight class="normal"></highlight></codeline>
<codeline lineno="76"><highlight class="normal"></highlight><highlight class="keyword">public</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="90" refid="classCollisionConfiguration_1a0215481eecb81a3068c3335cf0929104" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classCollisionConfiguration_1a0215481eecb81a3068c3335cf0929104" kindref="member">CollisionConfiguration</ref>(</highlight></codeline>
<codeline lineno="91"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>PC_tree_t<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal">&amp;<sp/>yaml_input_file,</highlight></codeline>
<codeline lineno="92"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classCollisionConfiguration_1af04c3dc20040cbe7a074981e9d153b85" kindref="member">IdxRangeDistributionFunctionType</ref><sp/>index_range_fdistribution,</highlight></codeline>
<codeline lineno="93"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>DConstField&lt;IdxRangeMuType&gt;<sp/>coeff_intdmu,</highlight></codeline>
<codeline lineno="94"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>DConstField&lt;IdxRangeVparType&gt;<sp/>coeff_intdvpar,</highlight></codeline>
<codeline lineno="95"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>B_norm,</highlight></codeline>
<codeline lineno="96"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>DConstField&lt;IdxRangeSpVparType&gt;<sp/>Bstar_s)</highlight></codeline>
<codeline lineno="97"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:<sp/><ref refid="classCollisionConfiguration_1abbb71a5c50b25e240239cac2439bfe47" kindref="member">m_operator_quantities</ref><sp/>{yaml_input_file,<sp/>index_range_fdistribution,<sp/>coeff_intdmu,<sp/>coeff_intdvpar}</highlight></codeline>
<codeline lineno="98"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>,<sp/><ref refid="classCollisionConfiguration_1a0706676008a4369fad2a2817ae531c31" kindref="member">m_nustar0</ref><sp/>{PCpp_double(yaml_input_file,<sp/></highlight><highlight class="stringliteral">&quot;.Collisions.nustar0_rpeak&quot;</highlight><highlight class="normal">)}</highlight></codeline>
<codeline lineno="99"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="100"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>nustar<sp/>fixed<sp/>to<sp/>1.<sp/>=&gt;<sp/>normalisation<sp/>of<sp/>time<sp/>is<sp/>equal<sp/>to<sp/>1./nustar</highlight></codeline>
<codeline lineno="101"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="102"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="classCollisionConfiguration_1a0706676008a4369fad2a2817ae531c31" kindref="member">m_nustar0</ref><sp/>!=<sp/>1.0)<sp/>{</highlight></codeline>
<codeline lineno="103"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">throw</highlight><highlight class="normal"><sp/>std::invalid_argument(</highlight><highlight class="stringliteral">&quot;nustar0<sp/>must<sp/>be<sp/>equal<sp/>to<sp/>1&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="104"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="105"><highlight class="normal"></highlight></codeline>
<codeline lineno="106"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classCollisionConfiguration_1a43d76d19ef1e45a5fa778c7c59f76471" kindref="member">do_configuration_data_initialisation</ref>(B_norm,<sp/>Bstar_s);</highlight></codeline>
<codeline lineno="107"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="108"><highlight class="normal"></highlight></codeline>
<codeline lineno="115" refid="classCollisionConfiguration_1a806514341ca2509be90b2db2d6d4fbe3" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="classCollisionConfiguration_1af6f098de78a916ed942a90890981acbe" kindref="member">CollisionConfigurationDataType</ref>&amp;<sp/><ref refid="classCollisionConfiguration_1a806514341ca2509be90b2db2d6d4fbe3" kindref="member">configuration</ref>()</highlight><highlight class="keyword"><sp/>const</highlight></codeline>
<codeline lineno="116"><highlight class="keyword"><sp/><sp/><sp/><sp/></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="117"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="classCollisionConfiguration_1abbb71a5c50b25e240239cac2439bfe47" kindref="member">m_operator_quantities</ref>;</highlight></codeline>
<codeline lineno="118"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="119"><highlight class="normal"></highlight></codeline>
<codeline lineno="120"><highlight class="normal"></highlight><highlight class="keyword">protected</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="127" refid="classCollisionConfiguration_1a43d76d19ef1e45a5fa778c7c59f76471" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classCollisionConfiguration_1a43d76d19ef1e45a5fa778c7c59f76471" kindref="member">do_configuration_data_initialisation</ref>(</highlight></codeline>
<codeline lineno="128"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>input_B_norm,</highlight></codeline>
<codeline lineno="129"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>DConstField&lt;IdxRangeSpVparType&gt;<sp/>input_Bstar_s)</highlight></codeline>
<codeline lineno="130"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="131"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="132"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>input_B_norm<sp/>is<sp/>a<sp/>scalar<sp/>when<sp/>there<sp/>is<sp/>no<sp/>Theta<sp/>nor<sp/>R<sp/>dimensions.</highlight></codeline>
<codeline lineno="133"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="134"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ddc::parallel_fill(</highlight></codeline>
<codeline lineno="135"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Kokkos::DefaultExecutionSpace(),</highlight></codeline>
<codeline lineno="136"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>get_field(<ref refid="classCollisionConfiguration_1abbb71a5c50b25e240239cac2439bfe47" kindref="member">m_operator_quantities</ref>.m_B_norm_allocation),</highlight></codeline>
<codeline lineno="137"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>input_B_norm);</highlight></codeline>
<codeline lineno="138"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="139"><highlight class="normal"></highlight></codeline>
<codeline lineno="140"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="141"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Koliop&apos;s<sp/>Bstar_s<sp/>is<sp/>needed<sp/>in<sp/>a<sp/>format<sp/>layout<sp/>different<sp/>from<sp/>the</highlight></codeline>
<codeline lineno="142"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>rest<sp/>of<sp/>the<sp/>code.<sp/>It<sp/>is<sp/>needed<sp/>in<sp/>layout<sp/>right</highlight></codeline>
<codeline lineno="143"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>[sp,<sp/>theta,<sp/>r,<sp/>vpar]<sp/>where<sp/>as<sp/>the<sp/>input<sp/>is<sp/>in<sp/>[sp,<sp/>vpar].</highlight></codeline>
<codeline lineno="144"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>We<sp/>simply<sp/>iterate<sp/>over<sp/>[sp,<sp/>theta,<sp/>r,<sp/>vpar]<sp/>and<sp/>copy<sp/>the<sp/>input</highlight></codeline>
<codeline lineno="145"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>[sp,<sp/>vpar]<sp/>for<sp/>every<sp/>theta,<sp/>r.</highlight></codeline>
<codeline lineno="146"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="147"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CollisionConfigurationDataType::transpose_replicate_deep_copy(</highlight></codeline>
<codeline lineno="148"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>get_field(<ref refid="classCollisionConfiguration_1abbb71a5c50b25e240239cac2439bfe47" kindref="member">m_operator_quantities</ref>.m_Bstar_s_allocation),</highlight></codeline>
<codeline lineno="149"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>input_Bstar_s);</highlight></codeline>
<codeline lineno="150"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="151"><highlight class="normal"></highlight></codeline>
<codeline lineno="152"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="153"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Computation<sp/>of<sp/>the<sp/>radial<sp/>profile<sp/>of<sp/>ADi<sp/>that<sp/>is<sp/>required<sp/>for</highlight></codeline>
<codeline lineno="154"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>koliop<sp/>interface</highlight></codeline>
<codeline lineno="155"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>@f[<sp/>AD(rpeak)<sp/>=<sp/>\sqrt(2)*eps_rpeak^(3/2)/(q_rpeak<sp/>R0)*nustar0_rpeak<sp/>@f]</highlight></codeline>
<codeline lineno="156"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>eps_rpeak<sp/>=<sp/>eps(rpeak)<sp/>with<sp/>eps(r)<sp/>=<sp/>r/R0<sp/>is<sp/>the<sp/>aspect<sp/>ratio.</highlight></codeline>
<codeline lineno="157"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*</highlight></codeline>
<codeline lineno="158"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>In<sp/>this<sp/>specific<sp/>case,<sp/>where<sp/>AD<sp/>is<sp/>a<sp/>scalar<sp/>all<sp/>values<sp/>are<sp/>forced</highlight></codeline>
<codeline lineno="159"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>to<sp/>1,<sp/>so<sp/>coeff_AD_atrpeak<sp/>=<sp/>sqrt(2)</highlight></codeline>
<codeline lineno="160"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="161"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>coeff_AD<sp/>=<sp/>Kokkos::sqrt(2.0);</highlight></codeline>
<codeline lineno="162"><highlight class="normal"></highlight></codeline>
<codeline lineno="163"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>[TODO]<sp/>According<sp/>to<sp/>Peter<sp/>D.,<sp/>the<sp/>places<sp/>where<sp/>coeff_AD<sp/>is<sp/>needed</highlight></codeline>
<codeline lineno="164"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>can<sp/>resynthesise<sp/>the<sp/>quantities<sp/>from<sp/>a<sp/>scalar<sp/>and<sp/>some<sp/>other</highlight></codeline>
<codeline lineno="165"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>fields<sp/>that<sp/>koliop<sp/>is<sp/>already<sp/>aware<sp/>of.<sp/>This<sp/>change<sp/>has<sp/>not</highlight></codeline>
<codeline lineno="166"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>landed<sp/>in<sp/>Gysela<sp/>Fortran<sp/>yet.<sp/>For<sp/>koliop<sp/>to<sp/>make<sp/>do<sp/>with<sp/>a<sp/>scalar</highlight></codeline>
<codeline lineno="167"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>and<sp/>not<sp/>a<sp/>radial<sp/>profile,<sp/>it<sp/>would<sp/>require<sp/>koliop<sp/>to<sp/>modify<sp/>its</highlight></codeline>
<codeline lineno="168"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>interface<sp/>and<sp/>the<sp/>Cpar<sp/>koliop<sp/>operator<sp/>computation<sp/>to<sp/>be<sp/>modified</highlight></codeline>
<codeline lineno="169"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>slightly.<sp/>For<sp/>now,<sp/>the<sp/>uniform<sp/>coeff_AD_rpeak<sp/>is<sp/>applied<sp/>to</highlight></codeline>
<codeline lineno="170"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>produce<sp/>a<sp/>koliop<sp/>compatible<sp/>radial<sp/>profile.</highlight></codeline>
<codeline lineno="171"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="172"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ddc::parallel_fill(</highlight></codeline>
<codeline lineno="173"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Kokkos::DefaultExecutionSpace(),</highlight></codeline>
<codeline lineno="174"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>get_field(<ref refid="classCollisionConfiguration_1abbb71a5c50b25e240239cac2439bfe47" kindref="member">m_operator_quantities</ref>.m_coeff_AD_allocation),</highlight></codeline>
<codeline lineno="175"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>coeff_AD);</highlight></codeline>
<codeline lineno="176"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="177"><highlight class="normal"></highlight></codeline>
<codeline lineno="178"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Kokkos::fence();</highlight></codeline>
<codeline lineno="179"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="180"><highlight class="normal"></highlight></codeline>
<codeline lineno="184" refid="classCollisionConfiguration_1abbb71a5c50b25e240239cac2439bfe47" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classCollisionConfiguration_1af6f098de78a916ed942a90890981acbe" kindref="member">CollisionConfigurationDataType</ref><sp/><ref refid="classCollisionConfiguration_1abbb71a5c50b25e240239cac2439bfe47" kindref="member">m_operator_quantities</ref>;</highlight></codeline>
<codeline lineno="185"><highlight class="normal"></highlight></codeline>
<codeline lineno="189" refid="classCollisionConfiguration_1a0706676008a4369fad2a2817ae531c31" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/><ref refid="classCollisionConfiguration_1a0706676008a4369fad2a2817ae531c31" kindref="member">m_nustar0</ref>;</highlight></codeline>
<codeline lineno="190"><highlight class="normal">};</highlight></codeline>
    </programlisting>
    <location file="/home/runner/work/gyselalibxx/gyselalibxx/code_branch/src/geometryVparMu/collisions/collision_configuration.hpp"/>
  </compounddef>
</doxygen>
