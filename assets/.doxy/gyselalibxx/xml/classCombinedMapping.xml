<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<doxygen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="compound.xsd" version="1.9.8" xml:lang="en-US">
  <compounddef id="classCombinedMapping" kind="class" language="C++" prot="public">
    <compoundname>CombinedMapping</compoundname>
    <includes refid="combined__mapping_8hpp" local="no">combined_mapping.hpp</includes>
    <templateparamlist>
      <param>
        <type>class Mapping1</type>
      </param>
      <param>
        <type>class Mapping2</type>
      </param>
      <param>
        <type>class CoordJacobianType</type>
        <defval>typename Mapping2::CoordResult</defval>
      </param>
    </templateparamlist>
    <sectiondef kind="public-type">
      <memberdef kind="typedef" id="classCombinedMapping_1abe12d94d3d899970931d2694d733d3a0" prot="public" static="no">
        <type>typename Mapping2::CoordArg</type>
        <definition>using CombinedMapping&lt; Mapping1, Mapping2, CoordJacobianType &gt;::CoordArg =  typename Mapping2::CoordArg</definition>
        <argsstring></argsstring>
        <name>CoordArg</name>
        <qualifiedname>CombinedMapping::CoordArg</qualifiedname>
        <briefdescription>
<para>The type of the argument of the function described by this mapping. </para>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/runner/work/gyselalibxx/gyselalibxx/code_branch/src/coord_transformations/combined_mapping.hpp" line="35" column="5" bodyfile="/home/runner/work/gyselalibxx/gyselalibxx/code_branch/src/coord_transformations/combined_mapping.hpp" bodystart="35" bodyend="-1"/>
      </memberdef>
      <memberdef kind="typedef" id="classCombinedMapping_1a2b8aa0a917ffcd246d9257c4623a08a5" prot="public" static="no">
        <type>typename Mapping1::CoordResult</type>
        <definition>using CombinedMapping&lt; Mapping1, Mapping2, CoordJacobianType &gt;::CoordResult =  typename Mapping1::CoordResult</definition>
        <argsstring></argsstring>
        <name>CoordResult</name>
        <qualifiedname>CombinedMapping::CoordResult</qualifiedname>
        <briefdescription>
<para>The type of the result of the function described by this mapping. </para>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/runner/work/gyselalibxx/gyselalibxx/code_branch/src/coord_transformations/combined_mapping.hpp" line="37" column="5" bodyfile="/home/runner/work/gyselalibxx/gyselalibxx/code_branch/src/coord_transformations/combined_mapping.hpp" bodystart="37" bodyend="-1"/>
      </memberdef>
      <memberdef kind="typedef" id="classCombinedMapping_1ab6600cd1c21a95897b6b7e0af20ff1d4" prot="public" static="no">
        <type>CoordJacobianType</type>
        <definition>using CombinedMapping&lt; Mapping1, Mapping2, CoordJacobianType &gt;::CoordJacobian =  CoordJacobianType</definition>
        <argsstring></argsstring>
        <name>CoordJacobian</name>
        <qualifiedname>CombinedMapping::CoordJacobian</qualifiedname>
        <briefdescription>
<para>The type of the coordinate that can be used to evaluate the Jacobian of this mapping. </para>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/runner/work/gyselalibxx/gyselalibxx/code_branch/src/coord_transformations/combined_mapping.hpp" line="39" column="5" bodyfile="/home/runner/work/gyselalibxx/gyselalibxx/code_branch/src/coord_transformations/combined_mapping.hpp" bodystart="39" bodyend="-1"/>
      </memberdef>
      <memberdef kind="typedef" id="classCombinedMapping_1a0d93115eb69d758d8a11a5b4f470fa8f" prot="public" static="no">
        <type><ref refid="classTensor" kindref="compound">DTensor</ref>&lt; ddc::to_type_seq_t&lt; <ref refid="classCombinedMapping_1a2b8aa0a917ffcd246d9257c4623a08a5" kindref="member">CoordResult</ref> &gt;, vector_index_set_dual_t&lt; ddc::to_type_seq_t&lt; <ref refid="classCombinedMapping_1abe12d94d3d899970931d2694d733d3a0" kindref="member">CoordArg</ref> &gt; &gt; &gt;</type>
        <definition>using CombinedMapping&lt; Mapping1, Mapping2, CoordJacobianType &gt;::JacobianMatrixType =  DTensor&lt; ddc::to_type_seq_t&lt;CoordResult&gt;, vector_index_set_dual_t&lt;ddc::to_type_seq_t&lt;CoordArg&gt; &gt;&gt;</definition>
        <argsstring></argsstring>
        <name>JacobianMatrixType</name>
        <qualifiedname>CombinedMapping::JacobianMatrixType</qualifiedname>
        <briefdescription>
<para>The type of the Jacobian matrix. </para>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/runner/work/gyselalibxx/gyselalibxx/code_branch/src/coord_transformations/combined_mapping.hpp" line="41" column="5" bodyfile="/home/runner/work/gyselalibxx/gyselalibxx/code_branch/src/coord_transformations/combined_mapping.hpp" bodystart="43" bodyend="-1"/>
      </memberdef>
      <memberdef kind="typedef" id="classCombinedMapping_1a1c59688cb74997538f6afa7d9769268a" prot="public" static="no">
        <type><ref refid="classTensor" kindref="compound">DTensor</ref>&lt; ddc::to_type_seq_t&lt; <ref refid="classCombinedMapping_1abe12d94d3d899970931d2694d733d3a0" kindref="member">CoordArg</ref> &gt;, vector_index_set_dual_t&lt; ddc::to_type_seq_t&lt; <ref refid="classCombinedMapping_1a2b8aa0a917ffcd246d9257c4623a08a5" kindref="member">CoordResult</ref> &gt; &gt; &gt;</type>
        <definition>using CombinedMapping&lt; Mapping1, Mapping2, CoordJacobianType &gt;::InvJacobianMatrixType =  DTensor&lt; ddc::to_type_seq_t&lt;CoordArg&gt;, vector_index_set_dual_t&lt;ddc::to_type_seq_t&lt;CoordResult&gt; &gt;&gt;</definition>
        <argsstring></argsstring>
        <name>InvJacobianMatrixType</name>
        <qualifiedname>CombinedMapping::InvJacobianMatrixType</qualifiedname>
        <briefdescription>
<para>The type of the inverse Jacobian matrix. </para>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/runner/work/gyselalibxx/gyselalibxx/code_branch/src/coord_transformations/combined_mapping.hpp" line="45" column="5" bodyfile="/home/runner/work/gyselalibxx/gyselalibxx/code_branch/src/coord_transformations/combined_mapping.hpp" bodystart="47" bodyend="-1"/>
      </memberdef>
    </sectiondef>
    <sectiondef kind="private-type">
      <memberdef kind="typedef" id="classCombinedMapping_1a68d8f009a20a024043aa0e6b9bc18207" prot="private" static="no">
        <type>ddc::type_seq_element_t&lt; 0, ddc::to_type_seq_t&lt; <ref refid="classCombinedMapping_1abe12d94d3d899970931d2694d733d3a0" kindref="member">CoordArg</ref> &gt; &gt;</type>
        <definition>using CombinedMapping&lt; Mapping1, Mapping2, CoordJacobianType &gt;::DimArg1 =  ddc::type_seq_element_t&lt;0, ddc::to_type_seq_t&lt;CoordArg&gt; &gt;</definition>
        <argsstring></argsstring>
        <name>DimArg1</name>
        <qualifiedname>CombinedMapping::DimArg1</qualifiedname>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/runner/work/gyselalibxx/gyselalibxx/code_branch/src/coord_transformations/combined_mapping.hpp" line="50" column="5" bodyfile="/home/runner/work/gyselalibxx/gyselalibxx/code_branch/src/coord_transformations/combined_mapping.hpp" bodystart="50" bodyend="-1"/>
      </memberdef>
      <memberdef kind="typedef" id="classCombinedMapping_1a4c08bd06ad49f8e1d0dab269f03b7e59" prot="private" static="no">
        <type>ddc::type_seq_element_t&lt; 1, ddc::to_type_seq_t&lt; <ref refid="classCombinedMapping_1abe12d94d3d899970931d2694d733d3a0" kindref="member">CoordArg</ref> &gt; &gt;</type>
        <definition>using CombinedMapping&lt; Mapping1, Mapping2, CoordJacobianType &gt;::DimArg2 =  ddc::type_seq_element_t&lt;1, ddc::to_type_seq_t&lt;CoordArg&gt; &gt;</definition>
        <argsstring></argsstring>
        <name>DimArg2</name>
        <qualifiedname>CombinedMapping::DimArg2</qualifiedname>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/runner/work/gyselalibxx/gyselalibxx/code_branch/src/coord_transformations/combined_mapping.hpp" line="51" column="5" bodyfile="/home/runner/work/gyselalibxx/gyselalibxx/code_branch/src/coord_transformations/combined_mapping.hpp" bodystart="51" bodyend="-1"/>
      </memberdef>
      <memberdef kind="typedef" id="classCombinedMapping_1a40c4311f2095df841ea7825e92440402" prot="private" static="no">
        <type>ddc::type_seq_element_t&lt; 0, ddc::to_type_seq_t&lt; <ref refid="classCombinedMapping_1a2b8aa0a917ffcd246d9257c4623a08a5" kindref="member">CoordResult</ref> &gt; &gt;</type>
        <definition>using CombinedMapping&lt; Mapping1, Mapping2, CoordJacobianType &gt;::DimResult1 =  ddc::type_seq_element_t&lt;0, ddc::to_type_seq_t&lt;CoordResult&gt; &gt;</definition>
        <argsstring></argsstring>
        <name>DimResult1</name>
        <qualifiedname>CombinedMapping::DimResult1</qualifiedname>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/runner/work/gyselalibxx/gyselalibxx/code_branch/src/coord_transformations/combined_mapping.hpp" line="52" column="5" bodyfile="/home/runner/work/gyselalibxx/gyselalibxx/code_branch/src/coord_transformations/combined_mapping.hpp" bodystart="52" bodyend="-1"/>
      </memberdef>
      <memberdef kind="typedef" id="classCombinedMapping_1a954c2537b8176d8bbd9f7c8dd7ec6e96" prot="private" static="no">
        <type>ddc::type_seq_element_t&lt; 1, ddc::to_type_seq_t&lt; <ref refid="classCombinedMapping_1a2b8aa0a917ffcd246d9257c4623a08a5" kindref="member">CoordResult</ref> &gt; &gt;</type>
        <definition>using CombinedMapping&lt; Mapping1, Mapping2, CoordJacobianType &gt;::DimResult2 =  ddc::type_seq_element_t&lt;1, ddc::to_type_seq_t&lt;CoordResult&gt; &gt;</definition>
        <argsstring></argsstring>
        <name>DimResult2</name>
        <qualifiedname>CombinedMapping::DimResult2</qualifiedname>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/runner/work/gyselalibxx/gyselalibxx/code_branch/src/coord_transformations/combined_mapping.hpp" line="53" column="5" bodyfile="/home/runner/work/gyselalibxx/gyselalibxx/code_branch/src/coord_transformations/combined_mapping.hpp" bodystart="53" bodyend="-1"/>
      </memberdef>
      <memberdef kind="typedef" id="classCombinedMapping_1a750e5ed678bd611774d45177151527de" prot="private" static="no">
        <type>typename Mapping2::CoordResult</type>
        <definition>using CombinedMapping&lt; Mapping1, Mapping2, CoordJacobianType &gt;::CoordIntermediate =  typename Mapping2::CoordResult</definition>
        <argsstring></argsstring>
        <name>CoordIntermediate</name>
        <qualifiedname>CombinedMapping::CoordIntermediate</qualifiedname>
        <briefdescription>
<para>The type of the intermediate coordinate of the transformations. </para>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/runner/work/gyselalibxx/gyselalibxx/code_branch/src/coord_transformations/combined_mapping.hpp" line="56" column="5" bodyfile="/home/runner/work/gyselalibxx/gyselalibxx/code_branch/src/coord_transformations/combined_mapping.hpp" bodystart="56" bodyend="-1"/>
      </memberdef>
    </sectiondef>
    <sectiondef kind="private-attrib">
      <memberdef kind="variable" id="classCombinedMapping_1aa31c3c209ae6e2c0162d744a42dd93da" prot="private" static="no" mutable="no">
        <type>Mapping1</type>
        <definition>Mapping1 CombinedMapping&lt; Mapping1, Mapping2, CoordJacobianType &gt;::m_mapping_1</definition>
        <argsstring></argsstring>
        <name>m_mapping_1</name>
        <qualifiedname>CombinedMapping::m_mapping_1</qualifiedname>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/runner/work/gyselalibxx/gyselalibxx/code_branch/src/coord_transformations/combined_mapping.hpp" line="59" column="14" bodyfile="/home/runner/work/gyselalibxx/gyselalibxx/code_branch/src/coord_transformations/combined_mapping.hpp" bodystart="59" bodyend="-1"/>
      </memberdef>
      <memberdef kind="variable" id="classCombinedMapping_1a89c66b4fdffc5db31f7bd0e0ee8b0578" prot="private" static="no" mutable="no">
        <type>Mapping2</type>
        <definition>Mapping2 CombinedMapping&lt; Mapping1, Mapping2, CoordJacobianType &gt;::m_mapping_2</definition>
        <argsstring></argsstring>
        <name>m_mapping_2</name>
        <qualifiedname>CombinedMapping::m_mapping_2</qualifiedname>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/runner/work/gyselalibxx/gyselalibxx/code_branch/src/coord_transformations/combined_mapping.hpp" line="60" column="14" bodyfile="/home/runner/work/gyselalibxx/gyselalibxx/code_branch/src/coord_transformations/combined_mapping.hpp" bodystart="60" bodyend="-1"/>
      </memberdef>
      <memberdef kind="variable" id="classCombinedMapping_1a023599e85b2489a3ce9a6a4fa8ad731a" prot="private" static="no" mutable="no">
        <type>double</type>
        <definition>double CombinedMapping&lt; Mapping1, Mapping2, CoordJacobianType &gt;::m_epsilon</definition>
        <argsstring></argsstring>
        <name>m_epsilon</name>
        <qualifiedname>CombinedMapping::m_epsilon</qualifiedname>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/runner/work/gyselalibxx/gyselalibxx/code_branch/src/coord_transformations/combined_mapping.hpp" line="61" column="12" bodyfile="/home/runner/work/gyselalibxx/gyselalibxx/code_branch/src/coord_transformations/combined_mapping.hpp" bodystart="61" bodyend="-1"/>
      </memberdef>
    </sectiondef>
    <sectiondef kind="public-func">
      <memberdef kind="function" id="classCombinedMapping_1a323492a6204c56e8b70143168a5f2845" prot="public" static="no" const="no" explicit="no" inline="yes" virt="non-virtual">
        <type></type>
        <definition>CombinedMapping&lt; Mapping1, Mapping2, CoordJacobianType &gt;::CombinedMapping</definition>
        <argsstring>(Mapping1 mapping_1, Mapping2 mapping_2, double epsilon=0.0)</argsstring>
        <name>CombinedMapping</name>
        <qualifiedname>CombinedMapping::CombinedMapping</qualifiedname>
        <param>
          <type>Mapping1</type>
          <declname>mapping_1</declname>
        </param>
        <param>
          <type>Mapping2</type>
          <declname>mapping_2</declname>
        </param>
        <param>
          <type>double</type>
          <declname>epsilon</declname>
          <defval>0.0</defval>
        </param>
        <briefdescription>
<para>Build a <ref refid="classCombinedMapping" kindref="compound">CombinedMapping</ref> from the component mappings. This constructor should be used if the inverse jacobian of the first mapping, or the jacobian of the second mapping cannot be evaluated at the O-point. </para>
        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername direction="in">mapping_1</parametername>
</parameternamelist>
<parameterdescription>
<para>The first mapping. </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">mapping_2</parametername>
</parameternamelist>
<parameterdescription>
<para>The second mapping. </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">epsilon</parametername>
</parameternamelist>
<parameterdescription>
<para>The parameter <formula id="17">$ \varepsilon $</formula> which determines when a point is close enough to the central O-point for linearisation to be required when calculating the inverse of the Jacobian. The Jacobian is linearised on <formula id="73">$ r \in [0, \varepsilon] $</formula>. </para>
</parameterdescription>
</parameteritem>
</parameterlist>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/runner/work/gyselalibxx/gyselalibxx/code_branch/src/coord_transformations/combined_mapping.hpp" line="75" column="5" bodyfile="/home/runner/work/gyselalibxx/gyselalibxx/code_branch/src/coord_transformations/combined_mapping.hpp" bodystart="75" bodyend="87"/>
      </memberdef>
      <memberdef kind="function" id="classCombinedMapping_1af3de08ff21e964132fa83d8bbdfa8776" prot="public" static="no" const="no" explicit="no" inline="yes" virt="non-virtual">
        <type><ref refid="classCombinedMapping_1a2b8aa0a917ffcd246d9257c4623a08a5" kindref="member">CoordResult</ref></type>
        <definition>CoordResult CombinedMapping&lt; Mapping1, Mapping2, CoordJacobianType &gt;::operator()</definition>
        <argsstring>(CoordArg coord)</argsstring>
        <name>operator()</name>
        <qualifiedname>CombinedMapping::operator()</qualifiedname>
        <param>
          <type><ref refid="classCombinedMapping_1abe12d94d3d899970931d2694d733d3a0" kindref="member">CoordArg</ref></type>
          <declname>coord</declname>
        </param>
        <briefdescription>
<para>Convert the argument coordinate to the equivalent result coordinate. </para>
        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername direction="in">coord</parametername>
</parameternamelist>
<parameterdescription>
<para>The coordinate to be converted.</para>
</parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>The equivalent coordinate. </para>
</simplesect>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/runner/work/gyselalibxx/gyselalibxx/code_branch/src/coord_transformations/combined_mapping.hpp" line="96" column="17" bodyfile="/home/runner/work/gyselalibxx/gyselalibxx/code_branch/src/coord_transformations/combined_mapping.hpp" bodystart="96" bodyend="99"/>
      </memberdef>
      <memberdef kind="function" id="classCombinedMapping_1aae0f04e41772585563d0b9be1070cec3" prot="public" static="no" const="yes" explicit="no" inline="yes" virt="non-virtual">
        <type>KOKKOS_INLINE_FUNCTION <ref refid="classCombinedMapping_1a0d93115eb69d758d8a11a5b4f470fa8f" kindref="member">JacobianMatrixType</ref></type>
        <definition>KOKKOS_INLINE_FUNCTION JacobianMatrixType CombinedMapping&lt; Mapping1, Mapping2, CoordJacobianType &gt;::jacobian_matrix</definition>
        <argsstring>(CoordJacobian const &amp;coord) const</argsstring>
        <name>jacobian_matrix</name>
        <qualifiedname>CombinedMapping::jacobian_matrix</qualifiedname>
        <param>
          <type><ref refid="classCombinedMapping_1ab6600cd1c21a95897b6b7e0af20ff1d4" kindref="member">CoordJacobian</ref> const &amp;</type>
          <declname>coord</declname>
        </param>
        <briefdescription>
<para>Compute full Jacobian matrix. </para>
        </briefdescription>
        <detaileddescription>
<para>For some computations, we need the complete Jacobian matrix or just the coefficients. This is calculated by combining the Jacobian matrices of the 2 curvilinear mappings.</para>
<para><formula id="74">$ J_{(x_{in}, y_{in})-&gt;(x_{out},y_{out})} = J_{F\circ G} $</formula> <formula id="75">$ = J_{(x_{mid}, y_{mid})-&gt;(x_{out},y_{out})}J_{(x_{in}, y_{in})-&gt;(x_{mid}, y_{mid})} = J_F J_G $</formula> <formula id="76">$ = J_{(x_{mid}, y_{mid})-&gt;(x_{out},y_{out})} [J_{(x_{mid}, y_{mid})-&gt;(x_{in}, y_{in})}]^{-1} = J_F [J_{G^{-1}}]^{-1} $</formula></para>
<para>The Jacobians that are used for the calculation must be mappings from <formula id="77">$ (x_{mid}, y_{mid}) $</formula> so they can be calculated on the correct coordinate system.</para>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername direction="in">coord</parametername>
</parameternamelist>
<parameterdescription>
<para>The coordinate where we evaluate the Jacobian matrix. </para>
</parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>The calculated Jacobian matrix. </para>
</simplesect>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/runner/work/gyselalibxx/gyselalibxx/code_branch/src/coord_transformations/combined_mapping.hpp" line="118" column="47" bodyfile="/home/runner/work/gyselalibxx/gyselalibxx/code_branch/src/coord_transformations/combined_mapping.hpp" bodystart="118" bodyend="138"/>
      </memberdef>
      <memberdef kind="function" id="classCombinedMapping_1a8ea5397c3808cff9bcb070b1cc1e0763" prot="public" static="no" const="yes" explicit="no" inline="yes" virt="non-virtual">
        <templateparamlist>
          <param>
            <type>class IndexTag1</type>
          </param>
          <param>
            <type>class IndexTag2</type>
          </param>
        </templateparamlist>
        <type>KOKKOS_INLINE_FUNCTION double</type>
        <definition>KOKKOS_INLINE_FUNCTION double CombinedMapping&lt; Mapping1, Mapping2, CoordJacobianType &gt;::jacobian_component</definition>
        <argsstring>(CoordJacobian const &amp;coord_rtheta) const</argsstring>
        <name>jacobian_component</name>
        <qualifiedname>CombinedMapping::jacobian_component</qualifiedname>
        <param>
          <type><ref refid="classCombinedMapping_1ab6600cd1c21a95897b6b7e0af20ff1d4" kindref="member">CoordJacobian</ref> const &amp;</type>
          <declname>coord_rtheta</declname>
        </param>
        <briefdescription>
<para>Compute the (i,j) component of the Jacobian matrix. </para>
        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername direction="in">coord_rtheta</parametername>
</parameternamelist>
<parameterdescription>
<para>The coordinate where we evaluate the Jacobian matrix. </para>
</parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>The (i,j) component of the Jacobian matrix. </para>
</simplesect>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/runner/work/gyselalibxx/gyselalibxx/code_branch/src/coord_transformations/combined_mapping.hpp" line="147" column="35" bodyfile="/home/runner/work/gyselalibxx/gyselalibxx/code_branch/src/coord_transformations/combined_mapping.hpp" bodystart="147" bodyend="151"/>
      </memberdef>
      <memberdef kind="function" id="classCombinedMapping_1a32c23aba0dc6f606e502c932a1d003cc" prot="public" static="no" const="yes" explicit="no" inline="yes" virt="non-virtual">
        <type>KOKKOS_INLINE_FUNCTION double</type>
        <definition>KOKKOS_INLINE_FUNCTION double CombinedMapping&lt; Mapping1, Mapping2, CoordJacobianType &gt;::jacobian</definition>
        <argsstring>(CoordJacobian const &amp;coord_rtheta) const</argsstring>
        <name>jacobian</name>
        <qualifiedname>CombinedMapping::jacobian</qualifiedname>
        <param>
          <type><ref refid="classCombinedMapping_1ab6600cd1c21a95897b6b7e0af20ff1d4" kindref="member">CoordJacobian</ref> const &amp;</type>
          <declname>coord_rtheta</declname>
        </param>
        <briefdescription>
<para>Compute the determinant of the Jacobian matrix. </para>
        </briefdescription>
        <detaileddescription>
<para><simplesect kind="see"><para><ref refid="classCombinedMapping_1aae0f04e41772585563d0b9be1070cec3" kindref="member">jacobian_matrix</ref> </para>
</simplesect>
<parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername direction="in">coord_rtheta</parametername>
</parameternamelist>
<parameterdescription>
<para>The coordinate where we evaluate the Jacobian matrix. </para>
</parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>The determinant of the Jacobian matrix. </para>
</simplesect>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/runner/work/gyselalibxx/gyselalibxx/code_branch/src/coord_transformations/combined_mapping.hpp" line="159" column="35" bodyfile="/home/runner/work/gyselalibxx/gyselalibxx/code_branch/src/coord_transformations/combined_mapping.hpp" bodystart="159" bodyend="162"/>
      </memberdef>
      <memberdef kind="function" id="classCombinedMapping_1af84a8fea2e82ba5c78ddedfea181e5f5" prot="public" static="no" const="yes" explicit="no" inline="yes" virt="non-virtual">
        <type>KOKKOS_FUNCTION <ref refid="classCombinedMapping_1a1c59688cb74997538f6afa7d9769268a" kindref="member">InvJacobianMatrixType</ref></type>
        <definition>KOKKOS_FUNCTION InvJacobianMatrixType CombinedMapping&lt; Mapping1, Mapping2, CoordJacobianType &gt;::inv_jacobian_matrix</definition>
        <argsstring>(CoordIntermediate const &amp;coord) const</argsstring>
        <name>inv_jacobian_matrix</name>
        <qualifiedname>CombinedMapping::inv_jacobian_matrix</qualifiedname>
        <param>
          <type>CoordIntermediate const &amp;</type>
          <declname>coord</declname>
        </param>
        <briefdescription>
<para>Compute the full inverse Jacobian matrix. </para>
        </briefdescription>
        <detaileddescription>
<para>If one of the mappings is singular then this function linearises the inverse Jacobian between the O-point and <formula id="78">$ r = \varepsilon $</formula>. The inverse Jacobian at the O-point is calculated using the class <ref refid="classInvJacobianOPoint" kindref="compound">InvJacobianOPoint</ref> in this case. The inverse Jacobian at a point where the matrices are not singular is calculated using non_singular_inverse_jacobian_matrix</para>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername direction="in">coord</parametername>
</parameternamelist>
<parameterdescription>
<para>The coordinate where we evaluate the inverse Jacobian matrix. </para>
</parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>The calculated inverse Jacobian matrix.</para>
</simplesect>
<simplesect kind="see"><para>non_singular_inverse_jacobian_matrix </para>
</simplesect>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/runner/work/gyselalibxx/gyselalibxx/code_branch/src/coord_transformations/combined_mapping.hpp" line="179" column="43" bodyfile="/home/runner/work/gyselalibxx/gyselalibxx/code_branch/src/coord_transformations/combined_mapping.hpp" bodystart="179" bodyend="201"/>
      </memberdef>
      <memberdef kind="function" id="classCombinedMapping_1a49604158bca91eb0e59fe8beb095c2ab" prot="public" static="no" const="yes" explicit="no" inline="yes" virt="non-virtual">
        <templateparamlist>
          <param>
            <type>class IndexTag1</type>
          </param>
          <param>
            <type>class IndexTag2</type>
          </param>
        </templateparamlist>
        <type>KOKKOS_INLINE_FUNCTION double</type>
        <definition>KOKKOS_INLINE_FUNCTION double CombinedMapping&lt; Mapping1, Mapping2, CoordJacobianType &gt;::inv_jacobian_component</definition>
        <argsstring>(CoordIntermediate const &amp;coord_rtheta) const</argsstring>
        <name>inv_jacobian_component</name>
        <qualifiedname>CombinedMapping::inv_jacobian_component</qualifiedname>
        <param>
          <type>CoordIntermediate const &amp;</type>
          <declname>coord_rtheta</declname>
        </param>
        <briefdescription>
<para>Compute the (i,j) coefficient of the inverse Jacobian matrix. </para>
        </briefdescription>
        <detaileddescription>
<para><simplesect kind="see"><para><ref refid="classCombinedMapping_1af84a8fea2e82ba5c78ddedfea181e5f5" kindref="member">inv_jacobian_matrix</ref> </para>
</simplesect>
<parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername direction="in">coord_rtheta</parametername>
</parameternamelist>
<parameterdescription>
<para>The coordinate where we evaluate the Jacobian matrix. </para>
</parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>The (i,j) coefficient of the Jacobian matrix. </para>
</simplesect>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/runner/work/gyselalibxx/gyselalibxx/code_branch/src/coord_transformations/combined_mapping.hpp" line="210" column="35" bodyfile="/home/runner/work/gyselalibxx/gyselalibxx/code_branch/src/coord_transformations/combined_mapping.hpp" bodystart="210" bodyend="215"/>
      </memberdef>
      <memberdef kind="function" id="classCombinedMapping_1a9f2e53eac9108d656fd843227fdc451d" prot="public" static="no" const="yes" explicit="no" inline="yes" virt="non-virtual">
        <type>KOKKOS_INLINE_FUNCTION double</type>
        <definition>KOKKOS_INLINE_FUNCTION double CombinedMapping&lt; Mapping1, Mapping2, CoordJacobianType &gt;::inv_jacobian</definition>
        <argsstring>(CoordIntermediate const &amp;coord_rtheta) const</argsstring>
        <name>inv_jacobian</name>
        <qualifiedname>CombinedMapping::inv_jacobian</qualifiedname>
        <param>
          <type>CoordIntermediate const &amp;</type>
          <declname>coord_rtheta</declname>
        </param>
        <briefdescription>
<para>Compute the determinant of the Jacobian matrix. </para>
        </briefdescription>
        <detaileddescription>
<para><simplesect kind="see"><para><ref refid="classCombinedMapping_1af84a8fea2e82ba5c78ddedfea181e5f5" kindref="member">inv_jacobian_matrix</ref> </para>
</simplesect>
<parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername direction="in">coord_rtheta</parametername>
</parameternamelist>
<parameterdescription>
<para>The coordinate where we evaluate the Jacobian matrix. </para>
</parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>The determinant of the Jacobian matrix. </para>
</simplesect>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/runner/work/gyselalibxx/gyselalibxx/code_branch/src/coord_transformations/combined_mapping.hpp" line="224" column="35" bodyfile="/home/runner/work/gyselalibxx/gyselalibxx/code_branch/src/coord_transformations/combined_mapping.hpp" bodystart="224" bodyend="227"/>
      </memberdef>
      <memberdef kind="function" id="classCombinedMapping_1a9ca64a62435219e248a9b4a0da886318" prot="public" static="no" const="yes" explicit="no" inline="yes" virt="non-virtual">
        <templateparamlist>
          <param>
            <type>class Mapping</type>
          </param>
        </templateparamlist>
        <type>KOKKOS_INLINE_FUNCTION Mapping const &amp;</type>
        <definition>KOKKOS_INLINE_FUNCTION Mapping const  &amp; CombinedMapping&lt; Mapping1, Mapping2, CoordJacobianType &gt;::get</definition>
        <argsstring>() const</argsstring>
        <name>get</name>
        <qualifiedname>CombinedMapping::get</qualifiedname>
        <briefdescription>
<para>Get access to one of the internal mappings. </para>
        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="templateparam"><parameteritem>
<parameternamelist>
<parametername>Mapping</parametername>
</parameternamelist>
<parameterdescription>
<para>The mapping that we want to access. </para>
</parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>A constant reference to the internal mapping. </para>
</simplesect>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/runner/work/gyselalibxx/gyselalibxx/code_branch/src/coord_transformations/combined_mapping.hpp" line="235" column="42" bodyfile="/home/runner/work/gyselalibxx/gyselalibxx/code_branch/src/coord_transformations/combined_mapping.hpp" bodystart="235" bodyend="243"/>
      </memberdef>
    </sectiondef>
    <sectiondef kind="private-func">
      <memberdef kind="function" id="classCombinedMapping_1af2a39b1a3c17e96b9ce968db9b9bccf1" prot="private" static="no" const="yes" explicit="no" inline="yes" virt="non-virtual">
        <type>KOKKOS_INLINE_FUNCTION <ref refid="classCombinedMapping_1a1c59688cb74997538f6afa7d9769268a" kindref="member">InvJacobianMatrixType</ref></type>
        <definition>KOKKOS_INLINE_FUNCTION InvJacobianMatrixType CombinedMapping&lt; Mapping1, Mapping2, CoordJacobianType &gt;::non_singular_inverse_jacobian_matrix</definition>
        <argsstring>(CoordIntermediate const &amp;coord) const</argsstring>
        <name>non_singular_inverse_jacobian_matrix</name>
        <qualifiedname>CombinedMapping::non_singular_inverse_jacobian_matrix</qualifiedname>
        <param>
          <type>CoordIntermediate const &amp;</type>
          <declname>coord</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>Compute the inverse Jacobian matrix at a point where the matrices are not singular.</para>
<para>This is calculated by combining the Jacobian matrices of the 2 curvilinear mappings.</para>
<para><formula id="79">$ [J_{(x_{in}, y_{in})-&gt;(x_{out},y_{out})}]^{-1} = [J_{F\circ G}]^{-1} $</formula> <formula id="80">$ = [J_{(x_{mid}, y_{mid})-&gt;(x_{out},y_{out})}J_{(x_{in}, y_{in})-&gt;(x_{mid}, y_{mid})}]^{-1} = [J_F J_G]^{-1} $</formula> <formula id="81">$ = J_{(x_{in}, y_{in})-&gt;(x_{mid}, y_{mid})}^{-1}J_{(x_{mid}, y_{mid})-&gt;(x_{out},y_{out})}^{-1} = J_G^{-1} J_F^{-1} $</formula> <formula id="82">$ = J_{(x_{mid}, y_{mid})-&gt;(x_{in}, y_{in})} J_{(x_{mid}, y_{mid})-&gt;(x_{out},y_{out})}^{-1} = J_{G^{-1}} J_F^{-1} $</formula></para>
<para>The Jacobians that are used for the calculation must be mappings from <formula id="77">$ (x_{mid}, y_{mid}) $</formula> so they can be calculated on the correct coordinate system.</para>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername direction="in">coord</parametername>
</parameternamelist>
<parameterdescription>
<para>The coordinate where we evaluate the Jacobian matrix. </para>
</parameterdescription>
</parameteritem>
</parameterlist>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/runner/work/gyselalibxx/gyselalibxx/code_branch/src/coord_transformations/combined_mapping.hpp" line="262" column="5" bodyfile="/home/runner/work/gyselalibxx/gyselalibxx/code_branch/src/coord_transformations/combined_mapping.hpp" bodystart="262" bodyend="283"/>
      </memberdef>
    </sectiondef>
    <briefdescription>
<para>A class which describes a mapping which is constructed by combining two mappings. Let us denote Mapping1 as <formula id="65">$ \mathcal{F} $</formula> and Mapping2 as <formula id="66">$ \mathcal{G} $</formula> then this mapping represents: <formula id="67">$ \mathcal{F} \circ \mathcal{G} $</formula>. </para>
    </briefdescription>
    <detaileddescription>
<para>There are therefore 3 domains in this calculation <formula id="68">$ \Omega_{start} $</formula>, <formula id="69">$ \Omega_{mid} $</formula> and <formula id="70">$ \Omega_{end} $</formula> with <formula id="71">$ \mathcal{F}(\Omega_{mid})\rightarrow\Omega_{end} $</formula> and <formula id="72">$ \mathcal{G}(\Omega_{start})\rightarrow\Omega_{mid} $</formula></para>
<para>The functions in this mapping are defined on the coordinate system associated with the domain <formula id="69">$ \Omega_{mid} $</formula>. </para>
    </detaileddescription>
    <location file="/home/runner/work/gyselalibxx/gyselalibxx/code_branch/src/coord_transformations/combined_mapping.hpp" line="24" column="1" bodyfile="/home/runner/work/gyselalibxx/gyselalibxx/code_branch/src/coord_transformations/combined_mapping.hpp" bodystart="25" bodyend="284"/>
    <listofallmembers>
      <member refid="classCombinedMapping_1a323492a6204c56e8b70143168a5f2845" prot="public" virt="non-virtual"><scope>CombinedMapping</scope><name>CombinedMapping</name></member>
      <member refid="classCombinedMapping_1abe12d94d3d899970931d2694d733d3a0" prot="public" virt="non-virtual"><scope>CombinedMapping</scope><name>CoordArg</name></member>
      <member refid="classCombinedMapping_1a750e5ed678bd611774d45177151527de" prot="private" virt="non-virtual"><scope>CombinedMapping</scope><name>CoordIntermediate</name></member>
      <member refid="classCombinedMapping_1ab6600cd1c21a95897b6b7e0af20ff1d4" prot="public" virt="non-virtual"><scope>CombinedMapping</scope><name>CoordJacobian</name></member>
      <member refid="classCombinedMapping_1a2b8aa0a917ffcd246d9257c4623a08a5" prot="public" virt="non-virtual"><scope>CombinedMapping</scope><name>CoordResult</name></member>
      <member refid="classCombinedMapping_1a68d8f009a20a024043aa0e6b9bc18207" prot="private" virt="non-virtual"><scope>CombinedMapping</scope><name>DimArg1</name></member>
      <member refid="classCombinedMapping_1a4c08bd06ad49f8e1d0dab269f03b7e59" prot="private" virt="non-virtual"><scope>CombinedMapping</scope><name>DimArg2</name></member>
      <member refid="classCombinedMapping_1a40c4311f2095df841ea7825e92440402" prot="private" virt="non-virtual"><scope>CombinedMapping</scope><name>DimResult1</name></member>
      <member refid="classCombinedMapping_1a954c2537b8176d8bbd9f7c8dd7ec6e96" prot="private" virt="non-virtual"><scope>CombinedMapping</scope><name>DimResult2</name></member>
      <member refid="classCombinedMapping_1a9ca64a62435219e248a9b4a0da886318" prot="public" virt="non-virtual"><scope>CombinedMapping</scope><name>get</name></member>
      <member refid="classCombinedMapping_1a9f2e53eac9108d656fd843227fdc451d" prot="public" virt="non-virtual"><scope>CombinedMapping</scope><name>inv_jacobian</name></member>
      <member refid="classCombinedMapping_1a49604158bca91eb0e59fe8beb095c2ab" prot="public" virt="non-virtual"><scope>CombinedMapping</scope><name>inv_jacobian_component</name></member>
      <member refid="classCombinedMapping_1af84a8fea2e82ba5c78ddedfea181e5f5" prot="public" virt="non-virtual"><scope>CombinedMapping</scope><name>inv_jacobian_matrix</name></member>
      <member refid="classCombinedMapping_1a1c59688cb74997538f6afa7d9769268a" prot="public" virt="non-virtual"><scope>CombinedMapping</scope><name>InvJacobianMatrixType</name></member>
      <member refid="classCombinedMapping_1a32c23aba0dc6f606e502c932a1d003cc" prot="public" virt="non-virtual"><scope>CombinedMapping</scope><name>jacobian</name></member>
      <member refid="classCombinedMapping_1a8ea5397c3808cff9bcb070b1cc1e0763" prot="public" virt="non-virtual"><scope>CombinedMapping</scope><name>jacobian_component</name></member>
      <member refid="classCombinedMapping_1aae0f04e41772585563d0b9be1070cec3" prot="public" virt="non-virtual"><scope>CombinedMapping</scope><name>jacobian_matrix</name></member>
      <member refid="classCombinedMapping_1a0d93115eb69d758d8a11a5b4f470fa8f" prot="public" virt="non-virtual"><scope>CombinedMapping</scope><name>JacobianMatrixType</name></member>
      <member refid="classCombinedMapping_1a023599e85b2489a3ce9a6a4fa8ad731a" prot="private" virt="non-virtual"><scope>CombinedMapping</scope><name>m_epsilon</name></member>
      <member refid="classCombinedMapping_1aa31c3c209ae6e2c0162d744a42dd93da" prot="private" virt="non-virtual"><scope>CombinedMapping</scope><name>m_mapping_1</name></member>
      <member refid="classCombinedMapping_1a89c66b4fdffc5db31f7bd0e0ee8b0578" prot="private" virt="non-virtual"><scope>CombinedMapping</scope><name>m_mapping_2</name></member>
      <member refid="classCombinedMapping_1af2a39b1a3c17e96b9ce968db9b9bccf1" prot="private" virt="non-virtual"><scope>CombinedMapping</scope><name>non_singular_inverse_jacobian_matrix</name></member>
      <member refid="classCombinedMapping_1af3de08ff21e964132fa83d8bbdfa8776" prot="public" virt="non-virtual"><scope>CombinedMapping</scope><name>operator()</name></member>
    </listofallmembers>
  </compounddef>
</doxygen>
